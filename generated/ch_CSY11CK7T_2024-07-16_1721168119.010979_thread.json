{
  "id": "ch_CSY11CK7T_2024-07-16_1721168119.010979_thread",
  "type": "channel",
  "channel_name": "discuss-frontend",
  "conversation_type": "thread",
  "participants": [
    "Weiming Wu",
    "Serena"
  ],
  "messages": [
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "@Weiming Wu i had a flaky unit test failure for `apps/src/aihub/hooks/__tests__/buildCrud.test.tsx` in this CI run (https://jenkins.instabase.com/blue/organizations/jenkins/instabase/detail/PR-59889/2/pipeline) - have you seen this before?",
      "time": "15:15",
      "timestamp": "1721168119.010979",
      "is_reply": false
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "the test passed locally for me 7/7 times though :lolcry:",
      "time": "15:19",
      "timestamp": "1721168392.892809",
      "is_reply": true
    },
    {
      "sender": "Weiming Wu",
      "user_id": "U03DZ9Y4MC2",
      "message": ":confused: Shouldn't `await waitFor()` already cover weird things like this? Agh",
      "time": "15:34",
      "timestamp": "1721169245.561379",
      "is_reply": true
    },
    {
      "sender": "Weiming Wu",
      "user_id": "U03DZ9Y4MC2",
      "message": "It looks like the test that's failing doesn't have the mock for:\n```      const invalidateQueriesMock = jest\n        .spyOn(queryClient, 'invalidateQueries')\n        .mockReturnValue({\n          // @ts-expect-error\n          then: fn => fn(),\n        });```\nmaybe that's it? Since it doesn't immediately trigger the .then() in invalidateQueries?",
      "time": "15:37",
      "timestamp": "1721169453.019339",
      "is_reply": true
    },
    {
      "sender": "Weiming Wu",
      "user_id": "U03DZ9Y4MC2",
      "message": "(Weird that it would still pass on our locals though...)",
      "time": "15:37",
      "timestamp": "1721169467.849049",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "maybe it only happens when multiple unit tests are run together? i was only running `apps/src/aihub/hooks/__tests__/buildCrud.test.tsx` locally, but in the CI run, maybe a previous test changed the mock state?",
      "time": "16:15",
      "timestamp": "1721171716.169699",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i reran CI, and it worked, so i guess it doesnâ€™t always fail in CI",
      "time": "16:16",
      "timestamp": "1721171776.724859",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "CSY11CK7T",
    "channel_name": "discuss-frontend",
    "date_file": "2024-07-16.json",
    "message_count": 7,
    "start_time": "1721168119.010979",
    "end_time": "1721171776.724859",
    "is_thread": true
  }
}