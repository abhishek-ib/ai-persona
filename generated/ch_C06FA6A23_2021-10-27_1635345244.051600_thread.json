{
  "id": "ch_C06FA6A23_2021-10-27_1635345244.051600_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "jtau",
    "Anil",
    "kunal"
  ],
  "messages": [
    {
      "sender": "jtau",
      "user_id": "U02F9FESZRN",
      "message": "this seems like an interesting flag that we could experiment with in some of our images:\nhttps://ubuntu.com/blog/we-reduced-our-docker-images-by-60-with-no-install-recommends",
      "time": "07:34",
      "timestamp": "1635345244.051600",
      "is_reply": false
    },
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": "checking this out",
      "time": "08:00",
      "timestamp": "1635346802.052800",
      "is_reply": true
    },
    {
      "sender": "kunal",
      "user_id": "U019YB70B8U",
      "message": "@jtau — this is super neat. should we give it a quick try and push it to a sandbox? If it just works, it’ll be a big, easy win.",
      "time": "08:04",
      "timestamp": "1635347044.053000",
      "is_reply": true
    },
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": "looks like we are already using it for example in app-tasks I see this flag already --no-install-recommends",
      "time": "08:07",
      "timestamp": "1635347243.053200",
      "is_reply": true
    },
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": "actually we are not using it everywhere - webdriver for example doesn't have it :confused:\ntrying locally to see if this makes a difference",
      "time": "08:13",
      "timestamp": "1635347632.053400",
      "is_reply": true
    },
    {
      "sender": "jtau",
      "user_id": "U02F9FESZRN",
      "message": "the other thing that we could try (though it comes with a slight tradeoff and is still somewhat experimental apparently) is to squash the layers in a docker image\nhttps://mresetar.github.io/2020-03-20-squashing-docker-images-for-smaller-size/",
      "time": "09:36",
      "timestamp": "1635352582.055100",
      "is_reply": true
    },
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": "I tried building the images with --no-install-recommends. It makes a small difference - 60MB saved in webdriver - 4.11GB -> 4.05\nDon't think it made much of a change for model-training-tasks. Might need to verify if it all works :slightly_smiling_face: @jtau you want to do the honor of changing in all docker files :slightly_smiling_face:",
      "time": "09:39",
      "timestamp": "1635352784.055400",
      "is_reply": true
    },
    {
      "sender": "jtau",
      "user_id": "U02F9FESZRN",
      "message": "made a small difference with the CP image as well, i'm going to try and see if squashing helps more",
      "time": "09:40",
      "timestamp": "1635352821.055700",
      "is_reply": true
    },
    {
      "sender": "jtau",
      "user_id": "U02F9FESZRN",
      "message": "still not crazy but about a 11% decrease in size, though CP is more barebones than other services so it might be more drastic with some of the larger services",
      "time": "09:54",
      "timestamp": "1635353677.055900",
      "is_reply": true
    },
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": ":open_mouth: squash feature is definitely interesting. Did you happen to try it on one of the bigger images listed above. 11% is quite significant.",
      "time": "10:32",
      "timestamp": "1635355931.056700",
      "is_reply": true
    },
    {
      "sender": "jtau",
      "user_id": "U02F9FESZRN",
      "message": "talked with @kunal and looks like we’re already squashing our cpp containers but seems like squashing downsides is you can’t cache layers and might lead to unexpected behaviors.\n\nbest bet going forward to reduce image size is to move our base images from ubuntu to alpine & consolidating our microservices",
      "time": "10:43",
      "timestamp": "1635356637.059100",
      "is_reply": true
    },
    {
      "sender": "kunal",
      "user_id": "U019YB70B8U",
      "message": "yeah! I think those are the two avenues we need to take long term — the issue with squashing is that you can’t cache layers when pulling the images, so net it might increase latency.",
      "time": "10:56",
      "timestamp": "1635357373.059400",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2021-10-27.json",
    "message_count": 12,
    "start_time": "1635345244.051600",
    "end_time": "1635357373.059400",
    "is_thread": true
  }
}