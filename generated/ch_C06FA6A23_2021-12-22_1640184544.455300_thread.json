{
  "id": "ch_C06FA6A23_2021-12-22_1640184544.455300_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Kerry",
    "Naveen",
    "Heymian",
    "Mark"
  ],
  "messages": [
    {
      "sender": "Mark",
      "user_id": "U0193NC7E9L",
      "message": "Running into the following when trying to disable a user on a sandbox - any ideas?",
      "time": "06:49",
      "timestamp": "1640184544.455300",
      "is_reply": false
    },
    {
      "sender": "Kerry",
      "user_id": "UCX3VGDJR",
      "message": "@Naveen - need to set up license table?",
      "time": "08:33",
      "timestamp": "1640190794.456100",
      "is_reply": true
    },
    {
      "sender": "Naveen",
      "user_id": "U0163TS8GR5",
      "message": "Yeah, I guess in latest code, during user removal, we also remove license assignment for user (we should check if licensing is enabled for prior releases. cc: @Heymian should we track this via JIRA for prior releases?).\n\nAfter we setup license table, it should be fine, @Mark can you run the command present in https://instabase.atlassian.net/wiki/spaces/CI/pages/1518993461/Licensing+Deployment#Deploy-licensing-to-a-customer[…]9s-on-release-21.4.0-and-later (https://instabase.atlassian.net/wiki/spaces/CI/pages/1518993461/Licensing+Deployment#Deploy-licensing-to-a-customer-that%E2%80%99s-on-release-21.4.0-and-later)\n\nYou will just need to run a curl command from your mac with IB token:\n```curl --location --request POST 'https://<IB_HOST>/api/v1/license-service/setup' \\\n--header 'Authorization: Bearer <api_access_token>' \\\n--header 'Accept-Encoding: application/json' \\\n--header 'Content-Type: application/json'```",
      "time": "08:37",
      "timestamp": "1640191025.456300",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "yup, you probably want to add a check to the license enabled flag before removing licenses",
      "time": "08:38",
      "timestamp": "1640191123.458500",
      "is_reply": true
    },
    {
      "sender": "Kerry",
      "user_id": "UCX3VGDJR",
      "message": "I see - so right now when removing a user we always look for the user’s licenses and try to remove them as well; this might lead to this error when licensing is not initialized in the environment (is this accurate? please correct me if not)",
      "time": "08:42",
      "timestamp": "1640191350.458700",
      "is_reply": true
    },
    {
      "sender": "Kerry",
      "user_id": "UCX3VGDJR",
      "message": "we should probably make initializing licensing a part of our standard sandbox deployment pipeline",
      "time": "08:45",
      "timestamp": "1640191522.459000",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "yup correct, so just need to wrap that delete licensing line with a check to the license enabled flag",
      "time": "08:50",
      "timestamp": "1640191834.459200",
      "is_reply": true
    },
    {
      "sender": "Mark",
      "user_id": "U0193NC7E9L",
      "message": "Should I be able to run this already @Naveen? I just get a response of License service not enabled",
      "time": "09:09",
      "timestamp": "1640192944.459500",
      "is_reply": true
    },
    {
      "sender": "Naveen",
      "user_id": "U0163TS8GR5",
      "message": "Oh, we may need to add license service deployments in the sandbox as well…",
      "time": "09:10",
      "timestamp": "1640193052.459800",
      "is_reply": true
    },
    {
      "sender": "Naveen",
      "user_id": "U0163TS8GR5",
      "message": "@Mark which sanbox, release is this?",
      "time": "09:13",
      "timestamp": "1640193202.460000",
      "is_reply": true
    },
    {
      "sender": "Mark",
      "user_id": "U0193NC7E9L",
      "message": "demo-2.aws.sandbox.instabase.com (http://demo-2.aws.sandbox.instabase.com) - 21.9",
      "time": "09:13",
      "timestamp": "1640193231.460200",
      "is_reply": true
    },
    {
      "sender": "Naveen",
      "user_id": "U0163TS8GR5",
      "message": "Ok, I see license service is deployed already in cluster, a one time fix to enable licensing is documented in the same doc mentioned above in the thread, applying that.",
      "time": "09:21",
      "timestamp": "1640193700.460500",
      "is_reply": true
    },
    {
      "sender": "Naveen",
      "user_id": "U0163TS8GR5",
      "message": "@Mark, can you resend the curl request now? (Enabled licensing for api-server only, which would not interrupt any Flows, but would allow us to setup licensing)\n```curl --location --request POST 'https://<IB_HOST>/api/v1/license-service/setup' \\\n--header 'Authorization: Bearer <api_access_token>' \\\n--header 'Accept-Encoding: application/json' \\\n--header 'Content-Type: application/json'```",
      "time": "09:25",
      "timestamp": "1640193942.460700",
      "is_reply": true
    },
    {
      "sender": "Mark",
      "user_id": "U0193NC7E9L",
      "message": "Worked, thanks!",
      "time": "10:39",
      "timestamp": "1640198363.460900",
      "is_reply": true
    },
    {
      "sender": "Kerry",
      "user_id": "UCX3VGDJR",
      "message": "Thanks @Naveen for resolving this! Let’s create a Jira task and fix the issue where we’ll see an error when deleting the user when licensing is disabled or not initialized.",
      "time": "10:45",
      "timestamp": "1640198750.461100",
      "is_reply": true
    },
    {
      "sender": "Mark",
      "user_id": "U0193NC7E9L",
      "message": "Thanks @Naveen, @Kerry and @Heymian!",
      "time": "10:49",
      "timestamp": "1640198966.461300",
      "is_reply": true
    },
    {
      "sender": "Naveen",
      "user_id": "U0163TS8GR5",
      "message": "Tracking this here: https://instabase.atlassian.net/browse/FLOW-2104, will work on this first thing tomorrow!",
      "time": "11:28",
      "timestamp": "1640201284.461500",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2021-12-22.json",
    "message_count": 17,
    "start_time": "1640184544.455300",
    "end_time": "1640201284.461500",
    "is_thread": true
  }
}