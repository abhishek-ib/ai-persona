{
  "id": "ch_C06FA6A23_2019-08-07_1565197434.238700_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Handsome Dave",
    "Aaron Vontell",
    "dlluncor",
    "Chetan"
  ],
  "messages": [
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Is there any change in the way we are running webdriver-tasks now? We are seeing this error in staging - `Could not truncate article: __init__() got an unexpected keyword argument 'encoding'`",
      "time": "10:03",
      "timestamp": "1565197434.238700",
      "is_reply": false
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "what code is triggering this?",
      "time": "10:12",
      "timestamp": "1565197925.240800",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Running NLP search",
      "time": "10:14",
      "timestamp": "1565198057.241000",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "But nothing has really changed in that part of the code,",
      "time": "10:14",
      "timestamp": "1565198078.241400",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "PY2 or PY3?",
      "time": "10:22",
      "timestamp": "1565198541.241900",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "^ that’s what I am curious about, if we changed the version of python being used on webdriver-tasks",
      "time": "10:23",
      "timestamp": "1565198587.242100",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "It depends on your virtual environment now",
      "time": "10:24",
      "timestamp": "1565198661.242300",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "So you have to manually switch to PY2 or PY3 venv to get your localhost to make the appropriate switch",
      "time": "10:24",
      "timestamp": "1565198692.242500",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "It was in an announcement to discuss-engineering about the PY3 updates -- if I can make it clearer let me know and I can do another announcement",
      "time": "10:25",
      "timestamp": "1565198717.242700",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Ah yes, I did not see that… So I am guessing we switched to PY3?",
      "time": "10:25",
      "timestamp": "1565198748.242900",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "This is on staging",
      "time": "10:26",
      "timestamp": "1565198763.243100",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "Oh interesting. That hasn't changed no, the Dockerfiles that is",
      "time": "10:32",
      "timestamp": "1565199124.243300",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "Perhaps you can check with @Handsome Dave -- he edited the Dockerfiles last, but not the code",
      "time": "10:32",
      "timestamp": "1565199162.243500",
      "is_reply": true
    },
    {
      "sender": "Handsome Dave",
      "user_id": "UKMAJ158V",
      "message": "The two changes to that dockerfile was removing:\n```\n  pip install --user ray==0.4.0 && \\\n  pip install --user pyOpenSSL==16.2.0 && \\\n```\nDo either of those seem like they could be the cause of this?",
      "time": "10:35",
      "timestamp": "1565199302.243700",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Hmmm don’t think so… I just ran this locally and everything works, gonna try to run locally on docker and see how things are",
      "time": "10:45",
      "timestamp": "1565199920.243900",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "I keep running out of space on docker so maybe not XD",
      "time": "10:59",
      "timestamp": "1565200742.244100",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Oh @Handsome Dave has anything changed with `msgpack`?",
      "time": "11:11",
      "timestamp": "1565201519.244300",
      "is_reply": true
    },
    {
      "sender": "Handsome Dave",
      "user_id": "UKMAJ158V",
      "message": "I don’t remember touching `msgpack` at all",
      "time": "11:12",
      "timestamp": "1565201560.244500",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Or the version of spacy?",
      "time": "11:12",
      "timestamp": "1565201560.244700",
      "is_reply": true
    },
    {
      "sender": "Handsome Dave",
      "user_id": "UKMAJ158V",
      "message": "I definitely didn’t touch `spacy`",
      "time": "11:12",
      "timestamp": "1565201573.244900",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "hmmm ok, I think the error is related to https://github.com/explosion/spaCy/issues/3696",
      "time": "11:13",
      "timestamp": "1565201611.245100",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "got it — we can fix the version of spacy and update mypy stubs to catch this at compile time ya?",
      "time": "11:14",
      "timestamp": "1565201646.245400",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "This is unrelated to the mypy issues I think, this is actually throwing an error during nlp analysis and causing NLP search to fail",
      "time": "11:15",
      "timestamp": "1565201721.245600",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "oh interesting — can’t help you there unfortunately — sounds like we’d need a unit-test to surround that code then",
      "time": "11:16",
      "timestamp": "1565201770.245800",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "@dlluncor unit tests pass because locally everything works, for some reason this is just happening when we deploy :sob:",
      "time": "11:17",
      "timestamp": "1565201853.246000",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Is there a way to ssh into the webdriver-tasks container on either staging or dogfood? I wonder if I can check and see what versions of spacy and msgpack are installed",
      "time": "11:18",
      "timestamp": "1565201888.246200",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "From what I am seeing online, this error occurs if `msgpack-numpy` is version 0.4.4.1 or higher",
      "time": "11:18",
      "timestamp": "1565201930.246400",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "yes there is — reach out to team-infra here on this one",
      "time": "11:28",
      "timestamp": "1565202502.246600",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Update on this I think we have the fix. I think be pure coincidence one of those pip dependencies we removed depended on a specific version of `msgpack-numpy`, which spacy then used. Now since it is not installed, spacy installs itself, but the version it installs is too new. I suspect pre-installing the older version fixes the issue, but I will not know until we can deploy (for some reason I can’t get docker working on my computer, keeps running out of memory)",
      "time": "12:34",
      "timestamp": "1565206489.247400",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Ok fix has been merged in: https://github.com/instabase/instabase/commit/6d19547a59e5683100634c7985e1e62a9278c663",
      "time": "12:43",
      "timestamp": "1565207019.247600",
      "is_reply": true
    },
    {
      "sender": "Handsome Dave",
      "user_id": "UKMAJ158V",
      "message": "Oh, that makes sense. Similar to the issue we had with kombu and celery.",
      "time": "12:43",
      "timestamp": "1565207037.247800",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "This will need to be cherry picked into the release branch I believe? @Handsome Dave were those dep changes included in the latest release?",
      "time": "12:44",
      "timestamp": "1565207058.248000",
      "is_reply": true
    },
    {
      "sender": "Handsome Dave",
      "user_id": "UKMAJ158V",
      "message": "That’s a good question. I know they were merged to master, but I don’t know where/when the latest release was cut.",
      "time": "12:44",
      "timestamp": "1565207096.248300",
      "is_reply": true
    },
    {
      "sender": "Handsome Dave",
      "user_id": "UKMAJ158V",
      "message": "I’d also like to add a comment to the dockerfile explicitly explaining why we’re installing that version, with a link to the spacy issue.",
      "time": "12:45",
      "timestamp": "1565207141.248500",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Ah got it, I’ll make that change and merge it in again. And looks like the changes weren’t in the release so it might be ok… I’ll check with infra",
      "time": "12:46",
      "timestamp": "1565207219.248700",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "Looks like release is still fine :+1:",
      "time": "13:05",
      "timestamp": "1565208311.248900",
      "is_reply": true
    },
    {
      "sender": "Aaron Vontell",
      "user_id": "UCWNLU6CB",
      "message": "^ looking back through the logs, it looks like this error has existing since about July 15th…. so not sure yet if this is the fix",
      "time": "13:14",
      "timestamp": "1565208879.249100",
      "is_reply": true
    },
    {
      "sender": "Handsome Dave",
      "user_id": "UKMAJ158V",
      "message": "Interesting. Lemme look at that Spacy issue again, now that I’m not in a conference call",
      "time": "13:23",
      "timestamp": "1565209425.249300",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2019-08-07.json",
    "message_count": 38,
    "start_time": "1565197434.238700",
    "end_time": "1565209425.249300",
    "is_thread": true
  }
}