{
  "id": "ch_C06FA6A23_2024-01-09_1704836690.271739_conversation",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "conversation",
  "participants": [
    "Dominic Fannjiang"
  ],
  "messages": [
    {
      "sender": "Dominic Fannjiang",
      "user_id": "U02TWH1FSG0",
      "message": "@mfichman Did DB migrations run successfully on uat.dogfood.instabase.com (http://uat.dogfood.instabase.com)? I'm testing out calling LLMs from refiner in enterprise platform, which triggers getting the source detail (https://github.com/instabase/instabase/blob/15db8db01f7e4b88109dc258625c8761e0ea61cc/shared-utils/py-utils/metrics-utils/src/py/instabase/metrics_utils/aihub_metrics_util.py#L157) in the `record_model_token_usage` decorator, which involves querying the DB for aihub projects, but in core-platform-service I see logs like `{\"caller\":\"coreplatformservice/aihub/handler.go:375\",\"level\":\"ERROR\",\"msg\":\"[INTERNAL]: Could not read projects (Err: pq: column ai_hub_projects.extraction_mode does not exist)\"}`. This is causing an exception to be thrown here (https://github.com/instabase/instabase/blob/15db8db01f7e4b88109dc258625c8761e0ea61cc/shared-utils/py-utils/metrics-utils/src/py/instabase/metrics_utils/aihub_metrics_util.py#L108) saying\n```AttributeError: 'NoneType' object has no attribute 'DESCRIPTOR'\n\n2024-01-09 13:12:15.334\t\n    message_descriptor = message.DESCRIPTOR\n2024-01-09 13:12:15.334\t\n  File \"/home/ibuser/.local/lib/python3.9/site-packages/google/protobuf/json_format.py\", line 203, in _MessageToJsonObject\n2024-01-09 13:12:15.334\t\n    return printer._MessageToJsonObject(message)\n2024-01-09 13:12:15.334\t\n  File \"/home/ibuser/.local/lib/python3.9/site-packages/google/protobuf/json_format.py\", line 168, in MessageToDict\n2024-01-09 13:12:15.334\t\n    project_detail = json_format.MessageToDict(resp)\n2024-01-09 13:12:15.334\t\n  File \"/instabase/workers/celery-app-tasks/py/instabase/metrics_utils/aihub_metrics_util.py\", line 108, in _get_source_detail\n2024-01-09 13:12:15.334\t\n    source_detail = _get_source_detail(source_type, source_id, project_id,\n2024-01-09 13:12:15.334\t\n  File \"/instabase/workers/celery-app-tasks/py/instabase/metrics_utils/aihub_metrics_util.py\", line 157, in inner```",
      "time": "13:44",
      "timestamp": "1704836690.271739",
      "is_reply": false
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2024-01-09.json",
    "message_count": 1,
    "start_time": "1704836690.271739",
    "end_time": "1704836690.271739",
    "is_thread": false
  }
}