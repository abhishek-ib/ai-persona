{
  "id": "ch_C06FA6A23_2021-03-03_1614813525.123800_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Paul H",
    "Mohit",
    "Ashish",
    "Chetan",
    "Jonathan Shih",
    "Daniel Cahn",
    "Jessica",
    "Erick"
  ],
  "messages": [
    {
      "sender": "Mohit",
      "user_id": "ULPBBF8PR",
      "message": "*Question regarding custom UIs/ recipebooks* :\n#1 Do we allow developers to write JS in a recipebook?\n#2 If yes, Does that mean a developer can access cookies of a receipebook-user?\n#3 If yes, Does that mean a developer can store cookies of all receipebook-users and literally login as those users?\n#4 If yes, isn’t this a serious security issue? :thinking_face: :this:\n\n[Disclaimer: My knowledge of frontend frameworks is potentially outdated.]\nNot sure who owns receipebook. Can someone please tag the appropriate person?",
      "time": "15:18",
      "timestamp": "1614813525.123800",
      "is_reply": false
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "answer to question #1 is definitely yes. not sure about the others.",
      "time": "15:20",
      "timestamp": "1614813651.124000",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "1. Yes, we allow developers to write javascript for recipebooks - that's the premise behind a custom UI, that it's completely custom\n2. Yes, the developer can store and access cookies. But then, you could do the same - trying opening up the console and running document.cookie, or going to the application tab and editing them directly from there\n3. That does not mean that having access to cookies allows the developer to login as those users\n4. So no, no security concerns! What developers can do writing custom UIs is no different from what they'd be able to do in the developer console",
      "time": "15:24",
      "timestamp": "1614813863.124300",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "And plex owns recipebook :slightly_smiling_face:",
      "time": "15:24",
      "timestamp": "1614813870.124500",
      "is_reply": true
    },
    {
      "sender": "Mohit",
      "user_id": "ULPBBF8PR",
      "message": "thanks for reply. @Jessica\nqq,\n>  But then, you could do the same\nEven though i can see my cookie in console ,but i wont share my cookies with anyone. In contrast, the recipebook author can access my cookies without me knowing.",
      "time": "15:27",
      "timestamp": "1614814032.124700",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "yup fair - which means that instabase developers need to be careful not to put anything sensitive in the cookies, which is standard best practice",
      "time": "15:29",
      "timestamp": "1614814143.125100",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "I think at some point we'll want to encapsulate the custom UIs so that they can't access/modify cookies and local storage (a la coderpad, for instance)",
      "time": "15:31",
      "timestamp": "1614814278.126600",
      "is_reply": true
    },
    {
      "sender": "Ashish",
      "user_id": "U3UJ09DJ6",
      "message": "I think Mohit is referring to a session hijack where Mohit can write a recipe book that Ashish uses. Mohit can write JS code in the recipe book that can ship Ashish's cookies to a location that Mohit has access to, and then can use those cookies to impersonate Ashish",
      "time": "15:32",
      "timestamp": "1614814353.127500",
      "is_reply": true
    },
    {
      "sender": "Mohit",
      "user_id": "ULPBBF8PR",
      "message": "qq,\n> 3. That does not mean that having access to cookies allows the developer to login as those users.\nAs per my understanding, the most basic use of cookies is used to maintain login sessions. [which we do as well AFAIK]\n\nSo, technically, the original premise of user impersonation still hold true. Am i missing something here?",
      "time": "15:33",
      "timestamp": "1614814425.129200",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "Yeah I think we store session id in cookies, so yes it’s a risk. (Recipe book is XSS as a feature)\n\n@Mohit I think there are bigger fish to fry security-wise on the backend. Like the ability to edit account dbs from any udf (upgrade myself to a site admin, reset your password and 2fa settings, log in as you)",
      "time": "15:34",
      "timestamp": "1614814444.129800",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "Ahh I see",
      "time": "15:34",
      "timestamp": "1614814488.130600",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "yeah it's definitely lower risk than, say, UDFs, and marketplace publishing is restricted by permissions, so theoretically a malicious custom UI wouldn't make it into marketplace at all",
      "time": "15:34",
      "timestamp": "1614814491.130900",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "but custom UIs can be executed without being uploaded to marketplace?",
      "time": "15:35",
      "timestamp": "1614814528.131200",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "(albeit yes backend security concerns are the real ones lol)",
      "time": "15:35",
      "timestamp": "1614814534.131400",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "(maybe i should make myself an admin on more customer sites… :troll:)",
      "time": "15:35",
      "timestamp": "1614814541.131800",
      "is_reply": true
    },
    {
      "sender": "Mohit",
      "user_id": "ULPBBF8PR",
      "message": "@Chetan AFAIK, yes, you can use custom UIs without publishing to marketplace",
      "time": "15:36",
      "timestamp": "1614814585.133400",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "Agreed both are concerns. Frontend one is more “standard” of a vulnerability and could be leveraged by a random script kiddie. Backend ones are more specific to us and need some intelligence to exploit.\n\nThe reason I’ve been told not to worry as much is because we trust anyone with a login to not be malicious in general. I think there’s a slight risk from university students on instabase.com (http://instabase.com), but not as much at customers.",
      "time": "15:38",
      "timestamp": "1614814703.135600",
      "is_reply": true
    },
    {
      "sender": "Mohit",
      "user_id": "ULPBBF8PR",
      "message": "@Erick for a udf developer to be able to do that wont they have to understand our API calls first? IMHO From that perspective, i think it has a higher barrier to entry than document.cookie. But yeah makes sense.",
      "time": "15:39",
      "timestamp": "1614814781.135800",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": ":point_up: yeah that's what I was thinking about - and in the case of these instabase.com (http://instabase.com) users, their main method of distribution would be marketplace, which they can't publish to - or sending a file to their classmates, but that doesn't seem like a likely scenario we need to guard against either",
      "time": "15:40",
      "timestamp": "1614814820.136500",
      "is_reply": true
    },
    {
      "sender": "Mohit",
      "user_id": "ULPBBF8PR",
      "message": ">  we trust anyone with a login to not be malicious in general \n@Erick i hope no security researcher sees this ever  haha.:troll:",
      "time": "15:40",
      "timestamp": "1614814835.136700",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "this is definitely high on the list of things we need to fix before hitting 5 billion in valuation :slightly_smiling_face:",
      "time": "15:55",
      "timestamp": "1614815738.137300",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "or trying anything SaaS",
      "time": "15:55",
      "timestamp": "1614815743.137500",
      "is_reply": true
    },
    {
      "sender": "Ashish",
      "user_id": "U3UJ09DJ6",
      "message": "_all this cookie talk is now making me have one!_",
      "time": "15:57",
      "timestamp": "1614815841.137800",
      "is_reply": true
    },
    {
      "sender": "Daniel Cahn",
      "user_id": "U01BA1SDWP4",
      "message": "@Mohit @Jessica nah you can prob use UDFs to understand the python API (just call like `dir(instabase)`, etc.",
      "time": "16:02",
      "timestamp": "1614816174.138700",
      "is_reply": true
    },
    {
      "sender": "Daniel Cahn",
      "user_id": "U01BA1SDWP4",
      "message": "oh sorry :joy: not @Jessica",
      "time": "16:03",
      "timestamp": "1614816236.139900",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "Yeah it would not be hard to exploit if someone wanted to",
      "time": "16:04",
      "timestamp": "1614816248.140500",
      "is_reply": true
    },
    {
      "sender": "Daniel Cahn",
      "user_id": "U01BA1SDWP4",
      "message": "You can also (e.g.) get our secrets (e.g. for our OCR engines) from `os.environ`",
      "time": "16:04",
      "timestamp": "1614816249.140700",
      "is_reply": true
    },
    {
      "sender": "Ashish",
      "user_id": "U3UJ09DJ6",
      "message": "if I may bring @Jonathan Shih into the mix here, i am sure he will also have some happy stories to recount on udf+security affair from his last hackathon",
      "time": "16:07",
      "timestamp": "1614816459.141300",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "If anyone wants to read some more about these :stuck_out_tongue:\n\nhttps://instabase.slack.com/archives/CV8V33RPV/p1612387243108300?thread_ts=1612384213.107500&cid=CV8V33RPV\nhttps://instabase.slack.com/archives/CJ7E9RG7Q/p1595258699431100?thread_ts=1595258656.430800&cid=CJ7E9RG7Q\nhttps://instabase.slack.com/archives/CJ7E9RG7Q/p1595258656430800\nhttps://instabase.slack.com/archives/C011FHLBN8N/p1593714432023200",
      "time": "16:08",
      "timestamp": "1614816481.141500",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "I would also be down to revive <#CD736UL5B|> for these kinds of discussions in the future. I think these are important issues to discuss even if we’re not fixing them right away yet",
      "time": "16:09",
      "timestamp": "1614816556.141800",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "i thought ssl helps to protect against session hijacks",
      "time": "16:10",
      "timestamp": "1614816647.142000",
      "is_reply": true
    },
    {
      "sender": "Ashish",
      "user_id": "U3UJ09DJ6",
      "message": "gee late to the party",
      "time": "16:11",
      "timestamp": "1614816666.142200",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "LOL someone only  tagged me 4 min ago",
      "time": "16:11",
      "timestamp": "1614816679.142400",
      "is_reply": true
    },
    {
      "sender": "Ashish",
      "user_id": "U3UJ09DJ6",
      "message": "client side code will hijack the cookie and ship it before ssl kicks in",
      "time": "16:11",
      "timestamp": "1614816717.143000",
      "is_reply": true
    },
    {
      "sender": "Ashish",
      "user_id": "U3UJ09DJ6",
      "message": "While all of you are on this topic, mind also pinging Anant on the need to hire a security engineer? :wink:",
      "time": "16:12",
      "timestamp": "1614816723.143200",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "can we just put everything on the blockchain? and run everything as code on top of a smart contract?",
      "time": "16:14",
      "timestamp": "1614816864.144900",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "ibcoin?",
      "time": "16:14",
      "timestamp": "1614816872.145100",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": ">  Mohit can write JS code in the recipe book that can ship Ashish’s cookies to a location that Mohit has access to, and then can use those cookies to impersonate Ashish\nWell put @Ashish. This is a common attack vector and in theory, is something that Custom UI should be vulnerable to. But I just checked and we’re not =)\n\nThat’s because we have the  (https://github.com/instabase/instabase/pull/13803)`HttpOnly` flag enabled on our cookies (https://github.com/instabase/instabase/pull/13803). One way to stop JS code from shipping cookie data to a remote location is to add the `HttpOnly` flag to cookies. This prevents JS code from accessing cookie data (`document.cookie` returns `\"\"`) and therefore, cannot send the session ID to a remote location.",
      "time": "20:37",
      "timestamp": "1614832672.145800",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "Ooh that definitely makes leveraging it a bit tougher.\n\nThat being said, it would still be fairly easy to write a request to `/api/v1/accounts/<any_user>/reset_password` in a recipe book, which would reset user passwords if any site admin stumbled upon that recipe book (or preview of it). More similar to UDF issue, where you would need to know a wee bit more about how our apis work to get that though.",
      "time": "20:46",
      "timestamp": "1614833192.146900",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "Indeed. That attack vector would be hard to stop =(",
      "time": "20:51",
      "timestamp": "1614833506.147200",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2021-03-03.json",
    "message_count": 40,
    "start_time": "1614813525.123800",
    "end_time": "1614833506.147200",
    "is_thread": true
  }
}