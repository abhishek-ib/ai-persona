{
  "id": "ch_C06FA6A23_2022-01-06_1641483504.004700_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Kerry",
    "kunal",
    "Ashish",
    "raghu",
    "sada",
    "Heymian",
    "alagar",
    "peter"
  ],
  "messages": [
    {
      "sender": "Kerry",
      "user_id": "UCX3VGDJR",
      "message": "<!here> hi team - @sada and @raghu put together a spreadsheet (https://docs.google.com/spreadsheets/d/19ai7ZJxfGRT176Uay7bwdcY68KbCCR9mH9R5Nuyva4w/edit) that records all the known network policies. can I have you take a look at the services that you work on, and make sure the polices are correctly recorded here, nothing is missing? This is important information for our customers when deploying Instabase, your help to create a first version of the complete list of network policies is highly appreciated! Thanks in advanced.",
      "time": "07:38",
      "timestamp": "1641483504.004700",
      "is_reply": false
    },
    {
      "sender": "Ashish",
      "user_id": "U3UJ09DJ6",
      "message": "Very useful! Thank you. Bookmarked.",
      "time": "08:20",
      "timestamp": "1641486030.005600",
      "is_reply": true
    },
    {
      "sender": "alagar",
      "user_id": "U02GNNRAWRK",
      "message": "how do we ensure we get to update this for every new release ?  . ideally, we need to rely on engg co-ordinator to keep this updated for every release; but we need a process.",
      "time": "08:27",
      "timestamp": "1641486435.005900",
      "is_reply": true
    },
    {
      "sender": "peter",
      "user_id": "U02NAREL9L7",
      "message": "Could we link this in Confluence as well for searchability?",
      "time": "09:17",
      "timestamp": "1641489467.006400",
      "is_reply": true
    },
    {
      "sender": "kunal",
      "user_id": "U019YB70B8U",
      "message": "@alagar I think we need enforcement — an environment where these are applied, enforced and tested so any missing NPs are found.",
      "time": "10:10",
      "timestamp": "1641492630.006800",
      "is_reply": true
    },
    {
      "sender": "Kerry",
      "user_id": "UCX3VGDJR",
      "message": "each team should review this for each release i think, and have the eng manager sign off for the portion that they own as a start",
      "time": "10:17",
      "timestamp": "1641493060.007000",
      "is_reply": true
    },
    {
      "sender": "alagar",
      "user_id": "U02GNNRAWRK",
      "message": "similar to deploy.py based deployment in PRE sandboxes now before we handover to customers, we can have these NP implemented in PRE sandboxes.. but the issue is we need to do elaborate testing to catch any missing policy.. can we use existing automated test-suite (if that does functional tests)  point to PRE sandbox and  validate this ?  .. manual validation is not going to help here.",
      "time": "10:22",
      "timestamp": "1641493326.007200",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "Agree with Kunal, these ultimately need to be auto generated or enforced by actually dogfooding the policies. It’s really not feasible to guarantee correctness of this by manual inspection and it’s not scalable to ask eveyr engineering who adds new env vars to talk to another service to remember to add to this separate spreadsheet.",
      "time": "13:14",
      "timestamp": "1641503642.008900",
      "is_reply": true
    },
    {
      "sender": "Kerry",
      "user_id": "UCX3VGDJR",
      "message": "Of course everything ideally should be automated and enforced, and yes manually reviewing things is not scalable. But until we have time to do automate this / until this is on any team’s roadmap, _something_ still needs to be available for our customers and our customer-facing people. Otherwise what we do now - having nothing & letting users deploy and fail and add policies ad-hoc - seems to just add stress to everybody. I can volunteer to be the person reminding engineers for every release this year to check this spreadsheet and update things, until we have an environment that tests and enforces policies. Engineers - thank you for reviewing this, knowing that this might take you 10 minutes to review but will save our customers weeks time recovering from deployment failure / adjustment.",
      "time": "14:03",
      "timestamp": "1641506627.010700",
      "is_reply": true
    },
    {
      "sender": "alagar",
      "user_id": "U02GNNRAWRK",
      "message": "This data is infact autogenerated via script (written by @sada/@raghu) which parse services information from deployments (i understand its hacky) so autogeneration is not a problem for now); and we can apply this in one of PRE sandbox as well to test.  But how do we validate ?  hence my ask to see if we can leverage existing functional test-suite if any.",
      "time": "18:22",
      "timestamp": "1641522178.012500",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "Oh cool! that was going to be my suggested trade-off - it probably only takes a day or so to write a script to parse the deployment files, which is probably less time and less error prone than wrangling the eng team to manually inspect 30+ service ymls. :stuck_out_tongue:",
      "time": "18:26",
      "timestamp": "1641522377.012800",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "Alagar, I don’t think we have an existing env up that requires network policies so i’m not sure where you could apply it. Would PRE be able to set one up to emulate natwest to validate?",
      "time": "18:29",
      "timestamp": "1641522580.013000",
      "is_reply": true
    },
    {
      "sender": "alagar",
      "user_id": "U02GNNRAWRK",
      "message": "we can.  but how do we validate? (manual validation of all functionalities is pain).",
      "time": "18:32",
      "timestamp": "1641522764.013200",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "oh i see, we have the golden and system test suite that can be run for testing functionality",
      "time": "18:33",
      "timestamp": "1641522786.014000",
      "is_reply": true
    },
    {
      "sender": "alagar",
      "user_id": "U02GNNRAWRK",
      "message": "ok. any doc on how we can leverage these tests ?",
      "time": "18:35",
      "timestamp": "1641522905.014200",
      "is_reply": true
    },
    {
      "sender": "alagar",
      "user_id": "U02GNNRAWRK",
      "message": "@sada, can we please use natwest-pre sandbox for applying these network policies and do the golden/system test suite once it is shared by Heymian ?",
      "time": "18:37",
      "timestamp": "1641523029.014400",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "yup for sure. i’ll send them over shortly",
      "time": "18:37",
      "timestamp": "1641523071.015400",
      "is_reply": true
    },
    {
      "sender": "sada",
      "user_id": "U02MVJ7EWLQ",
      "message": "Sure @alagar, I'll try to apply them to natwest-oct.aws.sandbox.instabase.com (http://natwest-oct.aws.sandbox.instabase.com) sandbox",
      "time": "18:41",
      "timestamp": "1641523316.015600",
      "is_reply": true
    },
    {
      "sender": "raghu",
      "user_id": "U023Z7LCZMZ",
      "message": "@sada lets use this as source and try it https://github.com/instabase/deployments/tree/master/customers/rbs/prod/networkpolicies/per-service",
      "time": "22:08",
      "timestamp": "1641535736.016600",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2022-01-06.json",
    "message_count": 19,
    "start_time": "1641483504.004700",
    "end_time": "1641535736.016600",
    "is_thread": true
  }
}