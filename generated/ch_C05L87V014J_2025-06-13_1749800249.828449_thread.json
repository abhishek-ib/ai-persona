{
  "id": "ch_C05L87V014J_2025-06-13_1749800249.828449_thread",
  "type": "channel",
  "channel_name": "ask-crafting",
  "conversation_type": "thread",
  "participants": [
    "prateek.tenkale",
    "Xindi Xu"
  ],
  "messages": [
    {
      "sender": "prateek.tenkale",
      "user_id": "U0817MND9J9",
      "message": "Uh oh, it looks like I don't have access to any of my data anymore. It's saying I ran out of credits and when I try to upgrade to commercial  This is what happened:\n1. I ran into this issue earlier today, I followed these steps and it worked fine\n2. I restarted `api-server` to test a change I made\n3. Noticed I was getting a 403 error on a request to `prateek-org` \n4. Tried these steps again, didn't seem to work\n5. Did `cs down && cs up`\n6. Now I see this :disappointed:",
      "time": "00:37",
      "timestamp": "1749800249.828449",
      "is_reply": false
    },
    {
      "sender": "prateek.tenkale",
      "user_id": "U0817MND9J9",
      "message": "",
      "time": "00:39",
      "timestamp": "1749800348.197209",
      "is_reply": true
    },
    {
      "sender": "prateek.tenkale",
      "user_id": "U0817MND9J9",
      "message": "When I try to upgrade to commercial, I can't access my old organization",
      "time": "00:39",
      "timestamp": "1749800378.532559",
      "is_reply": true
    },
    {
      "sender": "prateek.tenkale",
      "user_id": "U0817MND9J9",
      "message": "Site admin account (`<mailto:noreply_admin@instabase.com|noreply_admin@instabase.com>` has the same issue)",
      "time": "00:40",
      "timestamp": "1749800400.773369",
      "is_reply": true
    },
    {
      "sender": "prateek.tenkale",
      "user_id": "U0817MND9J9",
      "message": "When I try to create a new org (`prateek-org-2`), See the error below for the following request:\nhttps://https--ptenkale-instabase.instabase.site.sandboxes.run/api/v2/organizations/prateek-org-2\n```Payload: {\n    \"email\": \"<mailto:prateek.tenkale@instabase.com|prateek.tenkale@instabase.com>\",\n    \"org_full_name\": \"prateek-org-2\",\n    \"rate_card\": null,\n    \"stripe_payment_method_id\": \"pm_1RZSGNG94q149KmCcMGmWV5Y\"\n}```\nResponse:\n```{\n    \"message\": \"Error occurred executing GRPC method: Request /account_service.AccountService/CreateOrg failed. Error code=INTERNAL, Error=(13, 'internal'), Message: Failed to set roles: code = NOT_FOUND, msg = Missing valid roles for all role uuids. Non-retriable error\"\n}```",
      "time": "00:44",
      "timestamp": "1749800695.438519",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Make sure you run the post install actions correctly! After that, you need to rollback DB and reapply the migration 334",
      "time": "09:04",
      "timestamp": "1749830687.119839",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "If the DB doesn’t have the prebuilt roles set, the migration will still succeed, but no changes will be made",
      "time": "09:08",
      "timestamp": "1749830918.926599",
      "is_reply": true
    },
    {
      "sender": "prateek.tenkale",
      "user_id": "U0817MND9J9",
      "message": "Sounds good, I had ran it earlier in the day yesterday and it seemed to work fine until later in the day, but I'll give it another try.",
      "time": "09:23",
      "timestamp": "1749831803.587079",
      "is_reply": true
    },
    {
      "sender": "prateek.tenkale",
      "user_id": "U0817MND9J9",
      "message": "Do I rollback first and then follow the steps in your post?",
      "time": "09:23",
      "timestamp": "1749831814.092259",
      "is_reply": true
    },
    {
      "sender": "prateek.tenkale",
      "user_id": "U0817MND9J9",
      "message": "Steps I followed:\n1. ran post install actions\n2. bazel run tools/dbrollback\n3. bazel run tools/dbmigrate\nSeem to still be running into the same issue. I don't see a migration 334",
      "time": "09:30",
      "timestamp": "1749832214.241449",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "For 2, you’ll have to run it multiple times until you see “rollback 334….[0000]”",
      "time": "09:38",
      "timestamp": "1749832711.939769",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Btw, Prateek's sandbox was restored. The issue was that the steps were run in an old commit",
      "time": "10:59",
      "timestamp": "1749837558.129549",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C05L87V014J",
    "channel_name": "ask-crafting",
    "date_file": "2025-06-13.json",
    "message_count": 12,
    "start_time": "1749800249.828449",
    "end_time": "1749837558.129549",
    "is_thread": true
  }
}