{
  "id": "ch_C05L87V014J_2025-03-04_1741075200.654889_thread",
  "type": "channel",
  "channel_name": "ask-crafting",
  "conversation_type": "thread",
  "participants": [
    "mfichman",
    "Nikolaos Kofinas",
    "Vasu",
    "Serena"
  ],
  "messages": [
    {
      "sender": "Nikolaos Kofinas",
      "user_id": "U03DWCUEBHT",
      "message": "I did a git pull from master on my craftbox and did cs restart to restart all the services. After that, I cannot open any project (I get “failed to open project” errors) or create a new one\n\nThe only relevant logs that I find are from api-server:\n```172.17.0.1 - - [04/Mar/2025:07:58:49 +0000] \"GET /api/v2/aihub/build/projects/01955d9e-fc59-78f3-afde-69b38c2bcac4/validations?projectId=01955d9e-fc59-78f3-afde-69b38c2bcac4 HTTP/1.0\" 200 32 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/build/01955d9e-fc59-78f3-afde-69b38c2bcac4\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\n172.17.0.1 - - [04/Mar/2025:07:58:49 +0000] \"GET /api/v2/aihub/build/projects/01955d9e-fc59-78f3-afde-69b38c2bcac4/documents?sort_key=date_added&sort_is_ascending=false HTTP/1.0\" 200 3695 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/build/01955d9e-fc59-78f3-afde-69b38c2bcac4\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\n172.17.0.1 - - [04/Mar/2025:07:58:49 +0000] \"GET /api/v2/aihub/build/projects/01955d9e-fc59-78f3-afde-69b38c2bcac4/lock HTTP/1.0\" 200 136 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/build/01955d9e-fc59-78f3-afde-69b38c2bcac4\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\nlevel=ERROR time=2025-03-04 07:58:49,731 msg=\"Request /ai_hub_service.AIHubService/GetSchema failed. Error code=UNKNOWN, Error=(2, 'unknown'), Message: Error 1146 (42S02): Table 'ibdb.case_fields' doesn't exist. Non-retriable error\"  path=\"/instabase-api-server/py/instabase/utils/grpc/client.py:267\" process=\"MainProcess\" thread=\"ThreadPoolExecutor-0_2\" trace_id=\"\"\n172.17.0.1 - - [04/Mar/2025:07:58:49 +0000] \"GET /api/v2/aihub/build/projects/01955d9e-fc59-78f3-afde-69b38c2bcac4/schema HTTP/1.0\" 500 43 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/build/01955d9e-fc59-78f3-afde-69b38c2bcac4\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\n172.17.0.1 - - [04/Mar/2025:07:58:49 +0000] \"GET /api/v2/aihub/build/projects/default-drive?proj_id=01955d9e-fc59-78f3-afde-69b38c2bcac4 HTTP/1.0\" 200 257 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/build/01955d9e-fc59-78f3-afde-69b38c2bcac4\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\n172.17.0.1 - - [04/Mar/2025:07:58:50 +0000] \"GET /api/v2/aihub/build/projects?proj_id=01955d9e-fc59-78f3-afde-69b38c2bcac4&query_option=uuid HTTP/1.0\" 200 2783 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/build/01955d9e-fc59-78f3-afde-69b38c2bcac4\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\nlevel=ERROR time=2025-03-04 07:58:50,946 msg=\"Request /ai_hub_service.AIHubService/GetSchema failed. Error code=UNKNOWN, Error=(2, 'unknown'), Message: Error 1146 (42S02): Table 'ibdb.case_fields' doesn't exist. Non-retriable error\"  path=\"/instabase-api-server/py/instabase/utils/grpc/client.py:267\" process=\"MainProcess\" thread=\"ThreadPoolExecutor-0_1\" trace_id=\"\"\n172.17.0.1 - - [04/Mar/2025:07:58:50 +0000] \"GET /api/v2/aihub/build/projects/01955d9e-fc59-78f3-afde-69b38c2bcac4/schema HTTP/1.0\" 500 43 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/build/01955d9e-fc59-78f3-afde-69b38c2bcac4\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\n172.17.0.1 - - [04/Mar/2025:07:59:03 +0000] \"GET /api/v1/celery-handler/stats HTTP/1.1\" 200 32 \"-\" \"Go-http-client/1.1\"\nlevel=ERROR time=2025-03-04 07:59:05,258 msg=\"Error starting job. JobID=a90640c9-3de4-43a6-986c-8dfdfa537ac9, error=input_dir does not specify a valid directory.\"  path=\"/instabase-api-server/py/instabase/flow_handler/flow_handler.py:317\" process=\"MainProcess\" thread=\"ThreadPoolExecutor-0_0\" trace_id=\"\"\nlevel=ERROR time=2025-03-04 07:59:05,259 msg=\"Error starting Flow Job. BinaryPath=/system/global/fs/Instabase Drive/System/var/health/PlatformChecks/flow/helloworld.ibflowbin, input_dir=/system/global/fs/Instabase Drive/System/var/health/PlatformChecks/flow/datasets/inputbs, ibuser=__ib_system_admin_email__. Error=input_dir does not specify a valid directory.\"  path=\"/instabase-api-server/py/instabase/flow_handler/flow_handler.py:847\" process=\"MainProcess\" thread=\"ThreadPoolExecutor-0_0\" trace_id=\"\"\n172.17.0.1 - - [04/Mar/2025:07:59:05 +0000] \"POST /api/v1/flow/run_binary_async HTTP/1.1\" 200 75 \"-\" \"Go-http-client/1.1\"\n172.17.0.1 - - [04/Mar/2025:07:59:05 +0000] \"PUT /api/v2/files/system/global/fs/Instabase%20Drive/System/var/health/PlatformChecks/filesystem/write-file-check.txt HTTP/1.1\" 204 0 \"-\" \"Go-http-client/1.1\"\n\n\n\n\n\n\nlevel=ERROR time=2025-03-04 07:59:15,731 msg=\"Request /ai_hub_service.AIHubService/GetSchema failed. Error code=UNKNOWN, Error=(2, 'unknown'), Message: Error 1146 (42S02): Table 'ibdb.case_fields' doesn't exist. Non-retriable error\"  path=\"/instabase-api-server/py/instabase/utils/grpc/client.py:267\" process=\"MainProcess\" thread=\"ThreadPoolExecutor-0_2\" trace_id=\"\"\n172.17.0.1 - - [04/Mar/2025:07:59:15 +0000] \"GET /api/v2/aihub/build/projects/01955d9e-fc59-78f3-afde-69b38c2bcac4/schema HTTP/1.0\" 500 43 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/build/01955d9e-fc59-78f3-afde-69b38c2bcac4\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\n172.17.0.1 - - [04/Mar/2025:07:59:17 +0000] \"GET /api/v2/documents/review/count?order=ASCENDING&review_status=NOT_COMPLETED&review_status=IN_REVIEW&sort_by=reviewBy HTTP/1.0\" 200 12 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\n172.17.0.1 - - [04/Mar/2025:07:59:17 +0000] \"GET /api/v2/documents/review/list?limit=20&order=ASCENDING&review_status=NOT_COMPLETED&review_status=IN_REVIEW&sort_by=reviewBy HTTP/1.0\" 200 2 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\nlevel=ERROR time=2025-03-04 07:59:20,548 msg=\"Request /ai_hub_service.AIHubService/EditProjectSchema failed. Error code=UNKNOWN, Error=(2, 'unknown'), Message: Error 1146 (42S02): Table 'ibdb.case_fields' doesn't exist. Non-retriable error\"  path=\"/instabase-api-server/py/instabase/utils/grpc/client.py:267\" process=\"MainProcess\" thread=\"ThreadPoolExecutor-0_4\" trace_id=\"\"\n172.17.0.1 - - [04/Mar/2025:07:59:20 +0000] \"POST /api/v2/aihub/build/projects HTTP/1.0\" 500 277 \"https://https--nikolaoskofinas1-instabase.instabase.site.sandboxes.run/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\"\n172.17.0.1 - - [04/Mar/2025:07:59:33 +0000] \"GET /api/v1/celery-handler/stats HTTP/1.1\" 200 32 \"-\" \"Go-http-client/1.1\"```",
      "time": "00:00",
      "timestamp": "1741075200.654889",
      "is_reply": false
    },
    {
      "sender": "Vasu",
      "user_id": "U02RJRBS13R",
      "message": "It looks like some new changes were added to some DB schema, to fix this you need to run the following - `make -C $IB_HOME/shared-utils/go-utils/src/instabase/utils/db db-dev-init` , this would update the DB schema for your crafting environment to the latest.",
      "time": "00:06",
      "timestamp": "1741075561.616669",
      "is_reply": true
    },
    {
      "sender": "Nikolaos Kofinas",
      "user_id": "U03DWCUEBHT",
      "message": "that worked :smile: do we have a document with all this tips?",
      "time": "00:39",
      "timestamp": "1741077556.182519",
      "is_reply": true
    },
    {
      "sender": "Vasu",
      "user_id": "U02RJRBS13R",
      "message": "I see its added as part of the build hook to run after new code is pulled from the remote repo here (https://github.com/instabase/instabase/blob/master/.sandbox/ibdev-backend/hooks/build), so it should ideally auto run :thinking_face:",
      "time": "00:54",
      "timestamp": "1741078478.586829",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Yes, we have documentation, but it’s in the wrong place (database dev guide). Given the number of people who trip on this, I’ll move some instructions into the onboarding/crafting docs.\n\nBy the way, the build script only runs when creating a new sandbox. It doesn’t auto-run when pulling git. \n\nThere is a way to run the DB migrations when pulling in git — but I haven’t done it yet, because I wanted to give folks control over when the database migrations run. \n\nFor example, having migrations run when switching to experimental branch would be surprising. Likewise, rolling back migrations when switching to an older branch would also be surprising, as it could result in data loss (ex: dropping newly added tables). \n\nSo I think it’s better to keep it as a manual step for now. Open to other ideas, of course!",
      "time": "03:37",
      "timestamp": "1741088261.337019",
      "is_reply": true
    },
    {
      "sender": "Nikolaos Kofinas",
      "user_id": "U03DWCUEBHT",
      "message": "the logic behind the no automation is solid, I think the manual step which is also included on the guide will be the best",
      "time": "08:30",
      "timestamp": "1741105847.775429",
      "is_reply": true
    },
    {
      "sender": "Nikolaos Kofinas",
      "user_id": "U03DWCUEBHT",
      "message": "FYI where are the crafting docs? for such a long time I am leveraging an old presentation to get my tips. Can we pin the location to this channel?",
      "time": "08:31",
      "timestamp": "1741105892.539869",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Here: https://instabase.atlassian.net/wiki/spaces/TI/pages/2107605012/Development+Sandboxes+with+Crafting",
      "time": "09:03",
      "timestamp": "1741107832.941949",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "There is also the onboarding guide (https://docs.google.com/document/d/1yQOCxOISV_ukUxXdPJDoN-rERtOhdVRe7zv1swF1igw/edit), but that is limited to information directly required for setting up your dev environment.\nOther crafting troubleshooting instructions shouldn't go there.",
      "time": "09:05",
      "timestamp": "1741107922.451049",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "the information in https://instabase.atlassian.net/wiki/spaces/TI/pages/2107605012/Development+Sandboxes+with+Crafting pre-dates the `ibdev-backend` template though?\n\nwe need to create a specific page for just sandboxes that use the `ibdev-backend` template",
      "time": "10:46",
      "timestamp": "1741114011.229859",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i think we should deprecate the following 4 pages and start a new page for troubleshooting tips for `ibdev-backend` (ex: all the content from Matt's tech talk, running db migrations, etc)",
      "time": "10:48",
      "timestamp": "1741114138.076489",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Some of those are still relevant to the frontend/cypress sandboxes, but I agree that we could use a docs reorg here.",
      "time": "11:48",
      "timestamp": "1741117718.540119",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "yeah i was assuming that we want people to use `ibdev-backend` by default, so a reorg is probably more accurate\n\ni just marked some pages as \"Deprecated\" since we don't want engineers to use the old `ibdev` template / interception / etc\n\nand i started a new troubleshooting doc (https://instabase.atlassian.net/wiki/spaces/TI/pages/2823651329/Troubleshoot+ibdev-backend+sandbox) for just ibdev-backend!",
      "time": "14:06",
      "timestamp": "1741126005.534219",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "OK, thank you @Serena!",
      "time": "14:24",
      "timestamp": "1741127086.070429",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C05L87V014J",
    "channel_name": "ask-crafting",
    "date_file": "2025-03-04.json",
    "message_count": 14,
    "start_time": "1741075200.654889",
    "end_time": "1741127086.070429",
    "is_thread": true
  }
}