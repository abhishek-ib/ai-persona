{
  "id": "ch_CSY11CK7T_2024-10-16_1729109271.388709_thread",
  "type": "channel",
  "channel_name": "discuss-frontend",
  "conversation_type": "thread",
  "participants": [
    "Victor Zeng",
    "Xindi Xu",
    "Serena"
  ],
  "messages": [
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Seeing a lot of Cypress test failing due to this error in these runs: 1 (https://cloud.cypress.io/projects/cfhedy/runs/14751/overview/b4db060a-e485-40d4-b202-4f7917f86d44?roarHideRunsWithDiffGroupsAndTags=1), 2 (https://cloud.cypress.io/projects/cfhedy/runs/14752/overview/83428043-fbe2-4089-9601-32b09dee81d8?roarHideRunsWithDiffGroupsAndTags=1), 3 (https://cloud.cypress.io/projects/cfhedy/runs/14750/overview/bc0efb47-1e5d-4cae-a099-2393989257d0?roarHideRunsWithDiffGroupsAndTags=1)\n```Timed out retrying after 15000ms: Expected to find element: [data-testid=\"converse-project-name-label\"], [data-test-id=\"converse-project-name-label\"], but never found it.```\nIt happens because we only attach the test id after usage summary finishes loading (code (https://github.com/instabase/instabase/blob/c81a154ece623afa2d1fe7bd3d4fdce8f01c594c/webserver/shared/src/js/webpacked/apps/src/aihub/components/ProjectName.tsx#L170)), which takes a long time (~10 sec) but Cypress only waits for 15 sec.\n@Victor Zeng do you know why this endpoint takes so long? Any actions that require a license check will call this endpoint so ideally this endpoint needs to response very fast.\n\nWe only attach the test id when",
      "time": "13:07",
      "timestamp": "1729109271.388709",
      "is_reply": false
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "Which endpoint are we talking about?",
      "time": "13:08",
      "timestamp": "1729109320.942689",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i’ve been really confused about the recent failures, and didn’t realize that the issue is the `/api/v2/licenses/usage` endpoint!!\n\nthanks for looking into this!! @Xindi Xu",
      "time": "13:10",
      "timestamp": "1729109453.910039",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "there have been so many more flaky Cypress failures over the past week, and i couldn’t identify where the slowness was coming from :cry:",
      "time": "13:11",
      "timestamp": "1729109487.599509",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "@Victor Zeng Endpoint is GET https://crafting-cyp--pr-63728-cypress-instabase.instabase.site.sandboxes.run/api/v2/licenses/usage?start_time=[…]1-09T00%3A00%3A00&window_size=none (https://crafting-cyp--pr-63728-cypress-instabase.instabase.site.sandboxes.run/api/v2/licenses/usage?start_time=2024-10-09T00%3A00%3A00&end_time=2025-01-09T00%3A00%3A00&window_size=none)\nThis one takes 11 sec\nhttps://cloud.cypress.io/projects/cfhedy/runs/14752/overview/83428043-fbe2-4089-9601-[…]t=1&roarHideRunsWithDiffGroupsAndTags=1&ts=1729105518891.194 (https://cloud.cypress.io/projects/cfhedy/runs/14752/overview/83428043-fbe2-4089-9601-32b09dee81d8/replay?att=1&roarHideRunsWithDiffGroupsAndTags=1&ts=1729105518891.194)",
      "time": "13:14",
      "timestamp": "1729109679.324289",
      "is_reply": true
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "Let me see if I can find some traces.",
      "time": "13:15",
      "timestamp": "1729109754.185999",
      "is_reply": true
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "Looks like it's Metronome slowness :disappointed:",
      "time": "13:16",
      "timestamp": "1729109791.447709",
      "is_reply": true
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "",
      "time": "13:16",
      "timestamp": "1729109793.637809",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Hmm... that's pretty slow. Wonder if there are any other endpoints that checks the license state but it's faster.",
      "time": "13:19",
      "timestamp": "1729109992.593709",
      "is_reply": true
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "The `billing-plan` endpoint is the official license check endpoint.",
      "time": "13:24",
      "timestamp": "1729110260.787629",
      "is_reply": true
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "On prod it normally takes less than a second.",
      "time": "13:25",
      "timestamp": "1729110347.516399",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Good to know! We should update the code to use `billing-plan` endpoint then!",
      "time": "13:26",
      "timestamp": "1729110401.215279",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "CSY11CK7T",
    "channel_name": "discuss-frontend",
    "date_file": "2024-10-16.json",
    "message_count": 12,
    "start_time": "1729109271.388709",
    "end_time": "1729110401.215279",
    "is_thread": true
  }
}