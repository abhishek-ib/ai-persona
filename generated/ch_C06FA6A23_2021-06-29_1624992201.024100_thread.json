{
  "id": "ch_C06FA6A23_2021-06-29_1624992201.024100_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Venkatesh",
    "shaunak",
    "Nidhi",
    "achao"
  ],
  "messages": [
    {
      "sender": "achao",
      "user_id": "UH026QKA4",
      "message": "<!here> we have redeployed file-service a fix to improve memory utilization and enabled additional logging. It should be stable now. We are still investigating other solutions, please let us know if you experience any issues.",
      "time": "11:43",
      "timestamp": "1624992201.024100",
      "is_reply": false
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "For simulating the load — should we also start a parallel upload of 60k documents :smile:",
      "time": "11:55",
      "timestamp": "1624992906.024500",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "that is when things actually started to breat",
      "time": "11:55",
      "timestamp": "1624992914.024700",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "I am uploading 20K files now. This is my last batch. Will let you know if something breaks",
      "time": "12:00",
      "timestamp": "1624993228.025000",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": ":thumbsup_all:",
      "time": "12:00",
      "timestamp": "1624993239.025200",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "@Venkatesh - can you please hold of on uploading your last batch?",
      "time": "12:11",
      "timestamp": "1624993893.025600",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "Have you started it already?",
      "time": "12:11",
      "timestamp": "1624993898.025800",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "Hi Nidhi. I have. I can kill it for now if needed.",
      "time": "12:12",
      "timestamp": "1624993925.026000",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "I see, it’s ok. Let’s see what happens.",
      "time": "12:14",
      "timestamp": "1624994057.026500",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "cool",
      "time": "12:14",
      "timestamp": "1624994070.026700",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "it has reached the same state as last run",
      "time": "12:14",
      "timestamp": "1624994075.026900",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "Nothing is crashing though",
      "time": "12:15",
      "timestamp": "1624994104.027100",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "no, I think if refiner training were run right now, things would break. (presumably)?",
      "time": "12:15",
      "timestamp": "1624994130.027300",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "@shaunak - I’m looking at the memory usage right now, and most of the load seems to be going to 2 out of 10 pods.",
      "time": "12:16",
      "timestamp": "1624994188.027500",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "I ran a refiner to check. Seems to work",
      "time": "12:16",
      "timestamp": "1624994188.027700",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "Earlier the refiner didn't even load",
      "time": "12:16",
      "timestamp": "1624994199.027900",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "",
      "time": "12:17",
      "timestamp": "1624994222.028100",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "I have pushed a change to fix memory usage for reads, but still working on a change to fix it for writes.",
      "time": "12:18",
      "timestamp": "1624994290.028600",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "Yes, that is correct",
      "time": "12:18",
      "timestamp": "1624994313.028800",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "I’m guessing that is because when the channel first resolved, there were only 2 pods that were alive",
      "time": "12:18",
      "timestamp": "1624994339.029000",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "and now unless the pods die, there will be no rebalancing?",
      "time": "12:19",
      "timestamp": "1624994353.029200",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "Hmm, I see - Do you think there were only two pods when the channel first got resolved because we were redeploying?",
      "time": "12:20",
      "timestamp": "1624994421.029400",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "I think there are ~4ish pods right now that are actually serving traffic",
      "time": "12:20",
      "timestamp": "1624994448.029600",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "> Hmm, I see - Do you think there were only two pods when the channel first got resolved because we were redeploying?\nYes, that what my suspicion is as well",
      "time": "12:21",
      "timestamp": "1624994475.029800",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "I might have misunderstood how grpc load balancing works. My understanding was that the rebalancing problem was only while scaling up - but pod redeploys and restarts get picked up correctly.",
      "time": "12:21",
      "timestamp": "1624994476.030000",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "Yeah - I noticed there are 2 that are at almost 1GB memory and another 2 that are at 400MB memory. Not sure why out of the pods that are serving requests, two seems to be getting more load and the other two.",
      "time": "12:22",
      "timestamp": "1624994522.030200",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "yeah, so I suspect that our redeploys work fine because when we redeploy no one is actually using the system",
      "time": "12:30",
      "timestamp": "1624995032.030400",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "so the first request that initiates the channel connectivity happens when all pods are up and running",
      "time": "12:31",
      "timestamp": "1624995060.030600",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "Now it looks like all of then are being used. @Venkatesh - can you please stop your bulk upload if it is still going on? I am starting to see errors in the logs.",
      "time": "12:31",
      "timestamp": "1624995065.030800",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "is it okay to wait for 5 mins? it's the last 1000 files",
      "time": "12:32",
      "timestamp": "1624995127.031100",
      "is_reply": true
    },
    {
      "sender": "shaunak",
      "user_id": "UCY6SA014",
      "message": "@Nidhi yeah, that is because couple of pods restarted which resulted in a re resolution",
      "time": "12:32",
      "timestamp": "1624995174.031300",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "I think it will start impacting other people if we keep running this load. @Venkatesh, can we stop your upload now and upload the remaining files in some time?",
      "time": "12:33",
      "timestamp": "1624995212.031500",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "sure",
      "time": "12:33",
      "timestamp": "1624995224.031700",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "I've stopped it",
      "time": "12:34",
      "timestamp": "1624995273.031900",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "Thank you :pray:",
      "time": "12:35",
      "timestamp": "1624995306.032100",
      "is_reply": true
    },
    {
      "sender": "Venkatesh",
      "user_id": "U0134C9PPEF",
      "message": "sorry for the overload. and thanks for your support everyone",
      "time": "12:35",
      "timestamp": "1624995350.032300",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "@shaunak - strangely the GCP console only shows a total memory usage of 500MB for all of file-tservice for the last 30 mins. Any idea why the numbers from GCP vs grafana are so different? Which one should we rely on?",
      "time": "12:40",
      "timestamp": "1624995658.032500",
      "is_reply": true
    },
    {
      "sender": "Nidhi",
      "user_id": "U0179LPQK29",
      "message": "Thanks @Venkatesh - just wanted to avoid another outage :slightly_smiling_face:",
      "time": "12:42",
      "timestamp": "1624995720.032900",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2021-06-29.json",
    "message_count": 38,
    "start_time": "1624992201.024100",
    "end_time": "1624995720.032900",
    "is_thread": true
  }
}