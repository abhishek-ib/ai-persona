{
  "id": "ch_C06FA6A23_2024-02-07_1707352428.541779_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Xindi Xu"
  ],
  "messages": [
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Hey team! My PR (https://github.com/instabase/instabase/pull/53234) that adds a data migrator failed in CI with these tests. I wonder if anyone has some clues on why this failed :thinking_rotating:. It seems like it only failed when running tests against sqlite.\nOutput: https://jenkins.instabase.com/job/instabase/job/PR-53234/3/consoleText\n```2024-02-08T00:03:28.520Z] ----------------------------------------------------------------------\n[2024-02-08T00:03:28.520Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:147: DBMigrateTestSuite.TestMigrate2201\n[2024-02-08T00:03:28.520Z] \n[2024-02-08T00:03:28.520Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:152:\n[2024-02-08T00:03:28.520Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n[2024-02-08T00:03:28.520Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:48:\n[2024-02-08T00:03:28.520Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n[2024-02-08T00:03:28.520Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")```",
      "time": "16:33",
      "timestamp": "1707352428.541779",
      "is_reply": false
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "```\n[2024-02-08T00:45:41.236Z] ----------------------------------------------------------------------\n\n[2024-02-08T00:45:41.236Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:147: DBMigrateTestSuite.TestMigrate2201\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:152:\n\n[2024-02-08T00:45:41.236Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.236Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:48:\n\n[2024-02-08T00:45:41.236Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.236Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] 2024/02/08 00:45:07 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: no such table: main.users_old\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] ----------------------------------------------------------------------\n\n[2024-02-08T00:45:41.236Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:157: DBMigrateTestSuite.TestMigrate2204\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:162:\n\n[2024-02-08T00:45:41.236Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.236Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:48:\n\n[2024-02-08T00:45:41.236Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.236Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] 2024/02/08 00:45:09 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: no such table: main.users_old\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] ----------------------------------------------------------------------\n\n[2024-02-08T00:45:41.236Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:167: DBMigrateTestSuite.TestMigrate2205\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:172:\n\n[2024-02-08T00:45:41.236Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.236Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:48:\n\n[2024-02-08T00:45:41.236Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.236Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] 2024/02/08 00:45:10 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: no such table: main.users_old\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] ----------------------------------------------------------------------\n\n[2024-02-08T00:45:41.236Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:177: DBMigrateTestSuite.TestMigrate2208\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:182:\n\n[2024-02-08T00:45:41.236Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.236Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:48:\n\n[2024-02-08T00:45:41.236Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.236Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")\n\n[2024-02-08T00:45:41.236Z] \n\n[2024-02-08T00:45:41.236Z] 2024/02/08 00:45:29 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: no such table: failed\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.236Z] 2024/02/08 00:45:29 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: Error 1051 (42S02): Unknown table 'ns_32c8d135_0b4f_4f79_abfd_4ea7714afb30.failed'\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.236Z] 2024/02/08 00:45:29 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: pq: table \\\"failed\\\" does not exist\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.237Z] 2024/02/08 00:45:29 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: ORA-00942: table or view does not exist\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.237Z] 2024/02/08 00:45:30 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: mssql: Cannot drop the table 'failed', because it does not exist or you do not have permission.\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.237Z] 2024/02/08 00:45:31 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: no such table: main.users_old\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] ----------------------------------------------------------------------\n\n[2024-02-08T00:45:41.237Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:187: DBMigrateTestSuite.TestMigrateLatest\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:190:\n\n[2024-02-08T00:45:41.237Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.237Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:48:\n\n[2024-02-08T00:45:41.237Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.237Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] 2024/02/08 00:45:33 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: no such table: main.users_old\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] ----------------------------------------------------------------------\n\n[2024-02-08T00:45:41.237Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:203: DBMigrateTestSuite.TestMigrateOutOfOrder\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:206:\n\n[2024-02-08T00:45:41.237Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.237Z] shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go:105:\n\n[2024-02-08T00:45:41.237Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/migrate_test.go: no such file or directory\n\n[2024-02-08T00:45:41.237Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] 2024/02/08 00:45:34 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: no such table: main.users_old\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] ----------------------------------------------------------------------\n\n[2024-02-08T00:45:41.237Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go:112: DBRollbackTestSuite.TestRollback\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go:114:\n\n[2024-02-08T00:45:41.237Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go: no such file or directory\n\n[2024-02-08T00:45:41.237Z] shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go:39:\n\n[2024-02-08T00:45:41.237Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go: no such file or directory\n\n[2024-02-08T00:45:41.237Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] 2024/02/08 00:45:35 level=ERROR path=utils/db/session/tx.go:70 msg=\"SQL DB: no such table: main.users_old\" operation=db/session/TxImpl.Exec\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] ----------------------------------------------------------------------\n\n[2024-02-08T00:45:41.237Z] FAIL: shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go:119: DBRollbackTestSuite.TestRollbackToCheckpoint\n\n[2024-02-08T00:45:41.237Z] \n\n[2024-02-08T00:45:41.237Z] shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go:121:\n\n[2024-02-08T00:45:41.237Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go: no such file or directory\n\n[2024-02-08T00:45:41.237Z] shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go:39:\n\n[2024-02-08T00:45:41.237Z]     ...open shared-utils/go-utils/src/instabase/utils/db/tools/rollback_test.go: no such file or directory\n\n[2024-02-08T00:45:41.237Z] ... value *fmt.wrapError = &fmt.wrapError{msg:\"insertTable failed: no such table: main.users_old\", err:sqlite3.Error{Code:1, ExtendedCode:1, SystemErrno:0x0, err:\"no such table: main.users_old\"}} (\"insertTable failed: no such table: main.users_old\")```",
      "time": "16:51",
      "timestamp": "1707353471.896179",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2024-02-07.json",
    "message_count": 2,
    "start_time": "1707352428.541779",
    "end_time": "1707353471.896179",
    "is_thread": true
  }
}