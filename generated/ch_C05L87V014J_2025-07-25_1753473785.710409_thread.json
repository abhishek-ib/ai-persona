{
  "id": "ch_C05L87V014J_2025-07-25_1753473785.710409_thread",
  "type": "channel",
  "channel_name": "ask-crafting",
  "conversation_type": "thread",
  "participants": [
    "Jet",
    "Sayan"
  ],
  "messages": [
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "I want to update the credentials for AWS for Core platform service. I tried following this (https://docs.google.com/document/d/1YA1mqwNzrxFUN2m1hLT3-IooyJ6lPvShug76mL6A2Pg/edit?tab=t.0), adding it in env-local-overrides and restarting *CPS* (not api-server / CAT since this is affecting something else) but I get this error :thread:",
      "time": "13:03",
      "timestamp": "1753473785.710409",
      "is_reply": false
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "```#6 importing cache manifest from 549230430157.dkr.ecr.us-east-2.amazonaws.com/instabase-build/core-platform-service:cache (http://549230430157.dkr.ecr.us-east-2.amazonaws.com/instabase-build/core-platform-service:cache)\n#6 ERROR: failed to configure registry cache importer: unexpected status from HEAD request to https://549230430157.dkr.ecr.us-east-2.amazonaws.com/v2/instabase-build/core-platform-service/manifests/cache: 401 Unauthorized\n\n#4 [internal] load build context\n#4 transferring context: 32.10MB 0.1s\n#4 transferring context: 178.46MB 0.5s done\n#4 DONE 0.5s\n\n#7 [base 4/5] COPY --chmod=755 start.sh /instabase/start.sh\n#7 CACHED\n\n#8 [base 5/5] COPY --chmod=755 build/core-platform-service /instabase/bin/core-platform-service\n#8 CACHED\n\n#9 [base 2/5] RUN apk add --no-cache         bash         netcat-openbsd         wget     && wget --progress=dot:giga -O /bin/grpc_health_probe https://github.com/grpc-ecosystem/grpc-health-probe/releases/download/v0.2.0/grpc_health_probe-linux-amd64     && chmod +x /bin/grpc_health_probe     && apk del --no-cache --purge --rdepends         wget\n#9 CACHED\n\n#10 [base 3/5] COPY build/go.mod /go.mod\n#10 CACHED\n\n#11 [main 1/1] WORKDIR /instabase\n#11 CACHED\n\n#12 exporting to image\n#12 exporting layers done\n#12 exporting manifest sha256:e1d97dccdd3afa1ac597f07c6aa22a47b7dca6f81d054c5429bd36bc93dce674 done\n#12 exporting config sha256:95186110394472aa20dfcc0e486976df55fdb528a984e0dc09412cbb8bea1d64 done\n#12 exporting attestation manifest sha256:5b17a0b273cd4e108a862b516c4ef188e448cddc4a122869609ea8305c645412\n#12 exporting attestation manifest sha256:5b17a0b273cd4e108a862b516c4ef188e448cddc4a122869609ea8305c645412 0.0s done\n#12 exporting manifest list sha256:9dec090923c2eaec9d18d70a984e1b875da43eba232722d4b6ce68efe1c698a0 done\n#12 naming to docker.io/instabase/core-platform-service:latest (http://docker.io/instabase/core-platform-service:latest) done\n#12 unpacking to docker.io/instabase/core-platform-service:latest (http://docker.io/instabase/core-platform-service:latest) 0.0s done\n#12 DONE 0.1s\n\n#13 exporting cache to registry\n#13 preparing build cache for export\n#13 writing layer sha256:1b7766bb78ad668a9cb34d85d41965dc62b98022b5f70951a69135a2468441bd\n#13 preparing build cache for export 0.1s done\n#13 writing layer sha256:1b7766bb78ad668a9cb34d85d41965dc62b98022b5f70951a69135a2468441bd 0.0s done\n#13 ERROR: error writing layer blob: unexpected status from HEAD request to https://549230430157.dkr.ecr.us-east-2.amazonaws.com/v2/instabase-build/core-platform-service/blobs/sha256:1b7766bb78ad668a9cb34d85d41965dc62b98022b5f70951a69135a2468441bd: 401 Unauthorized\n------\n > importing cache manifest from 549230430157.dkr.ecr.us-east-2.amazonaws.com/instabase-build/core-platform-service:cache (http://549230430157.dkr.ecr.us-east-2.amazonaws.com/instabase-build/core-platform-service:cache):\n------\n------\n > exporting cache to registry:\n------\nERROR: failed to build: failed to solve: error writing layer blob: unexpected status from HEAD request to https://549230430157.dkr.ecr.us-east-2.amazonaws.com/v2/instabase-build/core-platform-service/blobs/sha256:1b7766bb78ad668a9cb34d85d41965dc62b98022b5f70951a69135a2468441bd: 401 Unauthorized\nmake: *** [Makefile:32: build-docker] Error 1```",
      "time": "13:03",
      "timestamp": "1753473792.912089",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "I think the issue that i'm seeing is that restarting services doesn't work but restarting the workspace does, specifically with core platform service. I've seen this for the past couple of days",
      "time": "13:16",
      "timestamp": "1753474568.243799",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "i ssh in CPS, didn't found any AWS varaible",
      "time": "14:10",
      "timestamp": "1753477836.872879",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "",
      "time": "14:10",
      "timestamp": "1753477850.904089",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "Use grep -i since I think we use AWS instead of aws",
      "time": "14:11",
      "timestamp": "1753477886.720059",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "oh uppercase.",
      "time": "14:11",
      "timestamp": "1753477899.794839",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "When you restarted services, did you see if CPS AWS key actually got changed?",
      "time": "14:13",
      "timestamp": "1753477990.880689",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "I didnt, but actually I think the issue isn't with AWS keys changing, rather `cs restart core-platform` gives the error above on step 5 or 6",
      "time": "14:14",
      "timestamp": "1753478043.854089",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "the error Unauthorized , maybe they key didn't get updated",
      "time": "14:14",
      "timestamp": "1753478089.264119",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "Cause yesterday the same thing happened when I was trying to rebuild CPS with changes not related to AWS",
      "time": "14:14",
      "timestamp": "1753478089.831749",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "The only workaround I found was restarting the workspace",
      "time": "14:15",
      "timestamp": "1753478133.871629",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "How do you trigger the error? By adding this?",
      "time": "14:16",
      "timestamp": "1753478197.256699",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "Yes and doing cs restart CPS",
      "time": "14:17",
      "timestamp": "1753478224.688229",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "ok, let me try it on my side too",
      "time": "14:17",
      "timestamp": "1753478238.272909",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "But one thing you can do is, instead of adding a config, try to add a print statement in a go file and restart it. I think the same error will show up when building CPS",
      "time": "14:18",
      "timestamp": "1753478281.517409",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "what go file , can you share the path?",
      "time": "14:19",
      "timestamp": "1753478353.887959",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "Yesterday I was editing `shared-utils/go-utils/src/instabase/coreplatformservice/repo/handler/deployed_solutions.go`",
      "time": "14:20",
      "timestamp": "1753478453.034429",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "FAILED: Build did NOT complete successfully\nmake: *** [Makefile:30: build-docker] Error 1\nmake: Leaving directory '/home/owner/instabase/core-services/core-platform-service'\nmake: Entering directory '/home/owner/instabase/core-services/core-platform-service'",
      "time": "14:25",
      "timestamp": "1753478716.538559",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "i added this",
      "time": "14:26",
      "timestamp": "1753478764.746679",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "Could you add that in a function? I think otherwise, it's syntactically incorrect",
      "time": "14:33",
      "timestamp": "1753479187.847779",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "ERROR: failed to build: failed to solve: 549230430157.dkr.ecr.us-east-2.amazonaws.com/instabase-build/go-db:19 (http://549230430157.dkr.ecr.us-east-2.amazonaws.com/instabase-build/go-db:19): failed to resolve source metadata for 549230430157.dkr.ecr.us-east-2.amazonaws.com/instabase-build/go-db:19 (http://549230430157.dkr.ecr.us-east-2.amazonaws.com/instabase-build/go-db:19): unexpected status from HEAD request to https://549230430157.dkr.ecr.us-east-2.amazonaws.com/v2/instabase-build/go-db/manifests/19: 401 Unauthorized",
      "time": "14:38",
      "timestamp": "1753479521.026659",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "https://instabase.atlassian.net/wiki/spaces/TI/pages/2823651329/Troubleshoot+ibdev-backend+sandbox#Q%3A-How-do-I-enable-ud[…]-are-being-picked-up%3F (https://instabase.atlassian.net/wiki/spaces/TI/pages/2823651329/Troubleshoot+ibdev-backend+sandbox#Q%3A-How-do-I-enable-udf-lambda-execution-on-my-crafting-sandbox-and-make-sure-my-custom-AWS-keys-are-being-picked-up%3F)",
      "time": "14:54",
      "timestamp": "1753480481.097659",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "```Make sure core-platform-service doesn't use these override AWS keys, since it needs env-local-secrets.json's for accessing files from S3 dogfood```",
      "time": "14:54",
      "timestamp": "1753480494.382179",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "for the ERROR: failed to build: failed to solve, i think i fixed it",
      "time": "14:56",
      "timestamp": "1753480571.772829",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "to fix this 401 issue, you need to modify\n\n.aws/credentials\n\n\nthen make ~/.docker/config.json\n\n{\n \"auths\": {}\n}\n\n\n\n\nthen you run aws ecr get-login-password --region us-east-2 | docker login --username AWS --password-stdin 549230430157.dkr.ecr.us-east-2.amazonaws.com (http://549230430157.dkr.ecr.us-east-2.amazonaws.com)",
      "time": "14:59",
      "timestamp": "1753480743.288989",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "It’s basically the same error we faced last week.",
      "time": "14:59",
      "timestamp": "1753480763.464629",
      "is_reply": true
    },
    {
      "sender": "Sayan",
      "user_id": "U07TLK5RJBS",
      "message": "Nice! Thank you @Jet! I don't have this issue right now but i'm going to look into it if this fixes it the next time",
      "time": "15:05",
      "timestamp": "1753481122.770979",
      "is_reply": true
    },
    {
      "sender": "Jet",
      "user_id": "U05FN1GES0J",
      "message": "this will be temp solution, afterward you need to switch it back to\nhttps://instabase.slack.com/archives/C05L87V014J/p1753388110844289",
      "time": "15:06",
      "timestamp": "1753481179.451919",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C05L87V014J",
    "channel_name": "ask-crafting",
    "date_file": "2025-07-25.json",
    "message_count": 29,
    "start_time": "1753473785.710409",
    "end_time": "1753481179.451919",
    "is_thread": true
  }
}