{
  "id": "ch_C06FA6A23_2020-04-29_1588209082.065900_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "dlluncor",
    "Aaron Tami",
    "Chetan",
    "Jonathan Shih",
    "Heymian"
  ],
  "messages": [
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "A segment of the PDF on the left turns into the image on the right when we converted the PDF to an image. Anyone seen this before and know how to work around it? This is BofA PPP-related",
      "time": "18:11",
      "timestamp": "1588209082.065900",
      "is_reply": false
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "cc @Anant @shaunak @Aaron Tami @Heymian maybe this is another PDF box bug?",
      "time": "18:11",
      "timestamp": "1588209114.066400",
      "is_reply": true
    },
    {
      "sender": "Aaron Tami",
      "user_id": "UGG8PLD2P",
      "message": "its erasing the check mark?",
      "time": "18:27",
      "timestamp": "1588210045.066800",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "it turns into the `^` in the corner of the checkbox @Aaron Tami",
      "time": "18:28",
      "timestamp": "1588210107.067000",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "not even sure that’s a `^`, just looks like three random angry pixels decided to appear there >.>",
      "time": "18:34",
      "timestamp": "1588210452.067300",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "Got a document for us to play with?",
      "time": "18:36",
      "timestamp": "1588210572.067700",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "yea one sec @Heymian",
      "time": "18:37",
      "timestamp": "1588210647.067900",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "https://instabase.com/dmitry_instabase/my-repo/fs/Instabase%20Drive/BugReports/PdfCheckboxLoss/input/fw4-2018-mock.pdf?content-disposition=raw @Heymian",
      "time": "18:37",
      "timestamp": "1588210665.068100",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "shared with `heymian` @Heymian",
      "time": "18:40",
      "timestamp": "1588210850.068300",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "sherlock has terribad handwriting",
      "time": "18:44",
      "timestamp": "1588211065.068600",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "i’m going to hunt for a workaround (image cv approach to get the weird `^` approach to get picked as a “yes this is filled in”)",
      "time": "18:48",
      "timestamp": "1588211295.068800",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "hrm I think it might be happening after pdf-service.",
      "time": "19:43",
      "timestamp": "1588214639.069000",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "The image that I get after plumbing that file thru pdf-service still has the checkmark intact",
      "time": "19:44",
      "timestamp": "1588214656.069200",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "@Chetan",
      "time": "19:44",
      "timestamp": "1588214681.069400",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "weird…  @Jonathan Shih any idea what might be causing it?",
      "time": "19:45",
      "timestamp": "1588214724.069600",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "",
      "time": "19:45",
      "timestamp": "1588214740.069800",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "that’s the jpg from a direct call into pdf-service to get the image back.",
      "time": "19:45",
      "timestamp": "1588214747.070200",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "huh did you try running it without the line removal code?",
      "time": "19:46",
      "timestamp": "1588214811.071100",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "yea, it shows up with just vanilla process files @Jonathan Shih",
      "time": "19:47",
      "timestamp": "1588214827.071300",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "weird… i don’t think we’re doing any other image processing. @Aaron Tami do you have any idea what might be happening?",
      "time": "19:48",
      "timestamp": "1588214909.071500",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "also happens on dogfood",
      "time": "19:48",
      "timestamp": "1588214924.071700",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "but yeah i’ll look into it",
      "time": "19:49",
      "timestamp": "1588214948.071900",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "thanks @Jonathan Shih, can repro it herehttps://www.instabase.com/apps/flow/edit/chetan/my-repo/fs/Instabase%20Drive/pdf-checkbox-templatematching/flow.ibflow#",
      "time": "19:49",
      "timestamp": "1588214973.072100",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "@Chetan that’s not loading? oh do i need access?",
      "time": "19:52",
      "timestamp": "1588215171.072300",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "jmshih",
      "time": "19:52",
      "timestamp": "1588215173.072500",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "one sec…",
      "time": "19:55",
      "timestamp": "1588215322.072700",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "done @Jonathan Shih",
      "time": "19:55",
      "timestamp": "1588215335.072900",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "my bad could have sworn you had access.",
      "time": "19:55",
      "timestamp": "1588215342.073100",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "haha thanks",
      "time": "19:55",
      "timestamp": "1588215355.073300",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "I saved the image right after sending it to pdfservice, and the returned image also has the weird checkmark",
      "time": "20:49",
      "timestamp": "1588218590.073500",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "@Heymian what request did you make to pdfservice? wondering if we’re calling it differently somehow",
      "time": "20:50",
      "timestamp": "1588218633.073700",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "I found a workaround that _should_ work, but narrowing down whose bug it is would be useful so I know where to file the ticket :slightly_smiling_face:",
      "time": "20:56",
      "timestamp": "1588219008.073900",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "what’s the workaround? also do you think it could be a font issue?",
      "time": "20:57",
      "timestamp": "1588219036.074100",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "the workaround is using template matching to identify the `^` in the corner as a checked box :slightly_smiling_face:",
      "time": "20:57",
      "timestamp": "1588219056.074300",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "not sure tbh — i don’t really understand how PDF fonts work.",
      "time": "20:57",
      "timestamp": "1588219079.074500",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "whatever works",
      "time": "20:58",
      "timestamp": "1588219085.074800",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "So another data point, I restarted PDFService locally, and it returns the correct image. I think it might actually have something to do with fonts",
      "time": "21:17",
      "timestamp": "1588220222.075000",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "although I don’t really know how so",
      "time": "21:17",
      "timestamp": "1588220239.075200",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "oh interesting, i did run it locally",
      "time": "21:17",
      "timestamp": "1588220245.075400",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "and not in our docker container, so it could be a font issue",
      "time": "21:17",
      "timestamp": "1588220253.075600",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "i have a unit test rig which lets me just call the parsePDF method directly",
      "time": "21:17",
      "timestamp": "1588220264.075800",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": ":open_mouth: that’s cool haha. can you try running it with docker just to make sure I didn’t screw something else up too?",
      "time": "21:18",
      "timestamp": "1588220294.076000",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "In PdfServiceTest.java look for a test called: `testParsePDFAsImage`",
      "time": "21:18",
      "timestamp": "1588220307.076200",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "yup for sure",
      "time": "21:18",
      "timestamp": "1588220308.076400",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "Yeah looking through the logs, docker is using Arial-Bold as a fallback for HelveticaLTStd-Bold, but locally, my computer is using Helvetica-Bold as a fallback for HelveticaLTStd-Bold. This might have to do with it. Can we get Helvetica into docker, or are there licensing issues?",
      "time": "21:21",
      "timestamp": "1588220498.076600",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "Oh weird, I now get a square (like missing character square)",
      "time": "21:21",
      "timestamp": "1588220501.076800",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "",
      "time": "21:21",
      "timestamp": "1588220518.077000",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "lol weird",
      "time": "21:22",
      "timestamp": "1588220521.077400",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "that is closer to what this SO post is talking about though: https://stackoverflow.com/questions/51392670/rendering-pdf-to-image-with-pdfbox-properly",
      "time": "21:22",
      "timestamp": "1588220564.077600",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "hrm no idea how to install helvetica",
      "time": "21:42",
      "timestamp": "1588221746.077900",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "@dlluncor you dealt with fonts in pdfservice before, right? How do you install a font?",
      "time": "21:43",
      "timestamp": "1588221789.078100",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "we’ve been using a couple of open source font pacakges\n```dpkg -i /tmp/ttf-mscorefonts-installer_3.6_all.deb && \\\n   apt-get install fonts-freefont-ttf fonts-liberation -y```",
      "time": "21:44",
      "timestamp": "1588221893.078300",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "oh hm",
      "time": "21:45",
      "timestamp": "1588221918.078500",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "and they basically have “backup”/fallback fonts for things like helevetica",
      "time": "21:45",
      "timestamp": "1588221934.078700",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "which are I think Adobe’s?",
      "time": "21:45",
      "timestamp": "1588221939.078900",
      "is_reply": true
    },
    {
      "sender": "dlluncor",
      "user_id": "U3UA06MFD",
      "message": "this is how we install additional fonts: https://github.com/instabase/instabase/blob/master/data-services/pdf-services/pdf-tservice/Dockerfile#L18 @Ashish was the one who added these fonts i believe to our Docker",
      "time": "21:53",
      "timestamp": "1588222403.079200",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "So it seems that the zapf dingbats font is some special thing, and the checkmark character is not an actual unicode character. I’m not sure what font we need to use in order to get this showing up properly",
      "time": "22:15",
      "timestamp": "1588223748.079500",
      "is_reply": true
    },
    {
      "sender": "Aaron Tami",
      "user_id": "UGG8PLD2P",
      "message": "sorry just catching up, so this is a pdf service font issue?",
      "time": "23:02",
      "timestamp": "1588226538.079900",
      "is_reply": true
    },
    {
      "sender": "Aaron Tami",
      "user_id": "UGG8PLD2P",
      "message": "is the checkmark part of the text?",
      "time": "23:02",
      "timestamp": "1588226552.080100",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "ya it seems like a font issue. If the font is not installed you get a square box. If we use the fallback fonts we currently have installed in the docker container, you get that caret symbol. If you run it on the mac, you get the checkbox.",
      "time": "23:12",
      "timestamp": "1588227123.080400",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2020-04-29.json",
    "message_count": 60,
    "start_time": "1588209082.065900",
    "end_time": "1588227123.080400",
    "is_thread": true
  }
}