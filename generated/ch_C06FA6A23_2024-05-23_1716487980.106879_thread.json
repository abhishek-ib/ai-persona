{
  "id": "ch_C06FA6A23_2024-05-23_1716487980.106879_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Armaan",
    "Serena"
  ],
  "messages": [
    {
      "sender": "Armaan",
      "user_id": "U047JSUBAPJ",
      "message": "Hi team -- In one of our SaaS environments (cassinfo.dev.instabase.com (http://cassinfo.dev.instabase.com)), we're running into a `Reduce UDF Exception: I/O operation on closed file`  when running export_as_excel(). It's failing when trying to writer.save() (https://github.com/instabase/ibtools/blob/main/ibtools/src/export_fns.py#L416C1-L416C22) the output file. We first saw this issue with ibtools 1.0.3, but are continuing to see it with ibtools 1.0.4.\n\nI do see that they have a higher version of Pandas than we expect, given an error they're seeing in their logs -- `Pandas requires version '1.4.3' or newer of 'xlsxwriter' (version '1.0.2' currently installed)`\n\nI'm attempting to recreate this issue with some of their files, but am not seeing the same result by running a post-flow UDF here (https://uat.dogfood.instabase.com/apps/flow/edit/armaan.dodd/armaan/fs/Instabase%20Drive/testflow7325/TestFlow.ibflow). Attaching logs to this ticket. Any idea what should be tested next?",
      "time": "11:13",
      "timestamp": "1716487980.106879",
      "is_reply": false
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "this thread seems similar https://instabase.slack.com/archives/CKBRX13L5/p1692296729667919",
      "time": "13:20",
      "timestamp": "1716495616.637349",
      "is_reply": true
    },
    {
      "sender": "Armaan",
      "user_id": "U047JSUBAPJ",
      "message": "I did see that, but it looks like those changes were incorporated some time ago? They should be in 1.0.4, so I wonder if this is a new issue.",
      "time": "13:21",
      "timestamp": "1716495668.712759",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "maybe you can ask @Pramod Munemanik then? it seems like he most recently worked on a fix in ibtools for this https://instabase.slack.com/archives/CKBRX13L5/p1693063663668809?thread_ts=1692296729.667919&cid=CKBRX13L5",
      "time": "13:22",
      "timestamp": "1716495760.699689",
      "is_reply": true
    },
    {
      "sender": "Armaan",
      "user_id": "U047JSUBAPJ",
      "message": "@Pramod Munemanik -- Could I ask for your input here when you have a chance to look?",
      "time": "13:23",
      "timestamp": "1716495786.142799",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2024-05-23.json",
    "message_count": 5,
    "start_time": "1716487980.106879",
    "end_time": "1716495786.142799",
    "is_thread": true
  }
}