{
  "id": "ch_C06FA6A23_2025-07-03_1751551201.302609_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "mfichman",
    "tony.shi"
  ],
  "messages": [
    {
      "sender": "tony.shi",
      "user_id": "U03R8QN7VQA",
      "message": "Hi! I'm running into some issues with mockAccessors on a PR (https://github.com/instabase/instabase/pull/71929) that was branched off a recent version of master (afternoon of Wed July 2nd). It includes this commit (https://github.com/instabase/instabase/pull/71874).\n\nWhen trying to run unit tests for core-platform-service, I run into the following mockAccessor errors:\n```(api-server-R9J_7aBi-py3.9) owner@dev:~/instabase/core-services/core-platform-service$ make test\ngolint /home/owner/instabase/core-services/core-platform-service/src/go/src/instabase/coreplatformservice/...\nwarning: \"/home/owner/instabase/core-services/core-platform-service/src/go/src/instabase/coreplatformservice/...\" matched no packages\nINFO: Writing tracer profile to '/home/owner/.cache/bazel/_bazel_owner/99c13e9d3f9affca3e421b943f545ec7/command.profile.gz'\nINFO: Invocation ID: a8d84292-2559-4532-a5b8-29b983966bd5\nINFO: Build option --test_env has changed, discarding analysis cache.\nINFO: Analyzed 56 targets (0 packages loaded, 44876 targets configured).\nINFO: Found 45 targets and 11 test targets...\nERROR: /home/owner/instabase/shared-utils/go-utils/src/instabase/coreplatformservice/database/handler/BUILD.bazel:25:11: GoCompilePkg shared-utils/go-utils/src/instabase/coreplatformservice/database/handler/handler_test.internal.a failed: (Exit 1): builder failed: error executing command (from target //shared-utils/go-utils/src/instabase/coreplatformservice/database/handler:handler_test) bazel-out/k8-opt-exec-2B5CBBC6/bin/external/go_linux_sdk/builder_reset/builder compilepkg -sdk external/go_linux_sdk -installsuffix linux_amd64 -src ... (remaining 103 arguments skipped)\n\nUse --sandbox_debug to see verbose messages from the sandbox and retain the sandbox build root for debugging\nshared-utils/go-utils/src/instabase/coreplatformservice/database/handler/database_service_test.go:118:22: cannot use mockAccessor (variable of type *\"instabase/mocks/utils/db/accessor\".PlatformAccessor) as \"instabase/utils/db/accessor\".PlatformAccessor value in argument to New: *\"instabase/mocks/utils/db/accessor\".PlatformAccessor does not implement \"instabase/utils/db/accessor\".PlatformAccessor (missing method DeleteAppDeploymentLinkRequests)```\nFurthermore, it seems like we can no longer manually rebuild mocks following this change (https://instabase.slack.com/archives/C011FHLBN8N/p1742994723252279)\n```(api-server-R9J_7aBi-py3.9) owner@dev:~/instabase/shared-utils/go-utils/src/instabase/utils/db$ make build-mocks \nMakefile:19: warning: overriding recipe for target 'run-golint'\n/home/owner/instabase/shared-utils/go-utils/src/instabase/utils/db/../../../../../../shared-utils/build-utils/shared/build-go.mk:42: warning: ignoring old recipe for target 'run-golint'\nmake: *** No rule to make target 'build-mocks'.  Stop.```\nTrying to regenerate mocks using shared-utils/go-utils/src/instabase/mocks/utils/db/accessor/mocks.go hits a different error\n```owner@dev:~/instabase/shared-utils/go-utils/src/instabase$ make generate\ngo generate ./protos\ngo generate ./mocks\n2025-07-02T21:55:32.159180592Z INF Starting mockery config-file=/home/owner/instabase/shared-utils/go-utils/src/instabase/.mockery.yml version=v3.5.0\n2025-07-02T21:55:32.159696890Z INF Parsing configured packages... version=v3.5.0\n2025-07-02T21:55:44.656886131Z ERR unable to parse packages error=\"getting package-level config: package net/http/internal/testcert does not exist in the config\" version=v3.5.0\n2025-07-02T21:55:44.656941198Z FTL app failed error=\"getting package-level config: package net/http/internal/testcert does not exist in the config\" version=v3.5.0\nmocks/generate.go:3: running \"go\": exit status 1\nmake: *** [Makefile:8: generate] Error 1```\nIs there any way to correctly regenerate mock accessors for my 2 new accessor functions? Thank you!!!\n\nCC: @mfichman",
      "time": "07:00",
      "timestamp": "1751551201.302609",
      "is_reply": false
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Hey Tony -- I'm dealing with an incident, so sorry for the slow response. Going to disable any tests that use these mocks (there are not many), and just remove these mocks. That's the quickest path forward now.",
      "time": "10:53",
      "timestamp": "1751565202.524489",
      "is_reply": true
    },
    {
      "sender": "tony.shi",
      "user_id": "U03R8QN7VQA",
      "message": "Thank you!",
      "time": "10:53",
      "timestamp": "1751565221.748499",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "PR: https://github.com/instabase/instabase/pull/71977",
      "time": "11:11",
      "timestamp": "1751566271.410769",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2025-07-03.json",
    "message_count": 4,
    "start_time": "1751551201.302609",
    "end_time": "1751566271.410769",
    "is_thread": true
  }
}