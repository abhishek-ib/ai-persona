{
  "id": "ch_C06FA6A23_2020-01-31_1580490289.263600_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Chetan",
    "Jonathan Shih",
    "Heymian",
    "will",
    "lydia",
    "Erick"
  ],
  "messages": [
    {
      "sender": "will",
      "user_id": "UJUJC82AG",
      "message": "Goldens have been failing on this test for a while, dp we have a list of who to ping about which golden test(s)?\n```The following tests failed:\n Test_name: multiflow_v2_binary_adp.\n Error=All records had a runtime exception. Last error observed was: 'NoneType' object has no attribute 'extract_resps'. See batch.ibflowresults for more info. \nSee the output results: /home/ib-build/workspace/dogfood-golden-tests/webserver/api-server-apps/build/golden-test/py/tmp/golden_results_1580490030.510324.txt```",
      "time": "09:04",
      "timestamp": "1580490289.263600",
      "is_reply": false
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "Looking at approximately when tests started failing, it looks like @lydia @Erick @rahul @Jonathan Shih merged in some PRs. Could someone please take a look at the failure and see if it relates to a PR they wrote?",
      "time": "13:59",
      "timestamp": "1580507974.274000",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "What’s the timeframe?",
      "time": "14:00",
      "timestamp": "1580508031.274300",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "yesterday morning was when it was first picked up, but we only run them once every 6hrs so it’s not a small window.",
      "time": "14:01",
      "timestamp": "1580508102.274500",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "how do i see any error messaging related to this?",
      "time": "14:04",
      "timestamp": "1580508265.274900",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "Here’s the failing jenkins job https://jenkins.instabase.com/job/dogfood-golden-tests/50//console",
      "time": "14:05",
      "timestamp": "1580508333.275100",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "is there a repo that we can run this on localhost?",
      "time": "14:07",
      "timestamp": "1580508420.275300",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "where are the golden test files?",
      "time": "14:07",
      "timestamp": "1580508425.275500",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "Trying to find that now :stuck_out_tongue:",
      "time": "14:07",
      "timestamp": "1580508437.275700",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "webserver/api-server-apps/test/golden-dataset-test/test_inputs/tests.json",
      "time": "14:08",
      "timestamp": "1580508480.275900",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "these are run using the golden test suite, which you can run locally",
      "time": "14:08",
      "timestamp": "1580508494.276100",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "looking for the docs for that now haha",
      "time": "14:08",
      "timestamp": "1580508504.276300",
      "is_reply": true
    },
    {
      "sender": "will",
      "user_id": "UJUJC82AG",
      "message": "This is a list of changes from when that particular test broke: https://jenkins.instabase.com/view/Tests/job/dogfood-golden-tests/46/",
      "time": "14:08",
      "timestamp": "1580508529.276500",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "https://docs.google.com/document/d/1pqMW_9rt34othaUTTiYFSRjJxfJleWgZES-wEH5UsHI/edit",
      "time": "14:09",
      "timestamp": "1580508555.276700",
      "is_reply": true
    },
    {
      "sender": "will",
      "user_id": "UJUJC82AG",
      "message": "`cd webserver/api-server-apps && make run-golden-test` , i think it runs locally by default",
      "time": "14:09",
      "timestamp": "1580508585.277000",
      "is_reply": true
    },
    {
      "sender": "will",
      "user_id": "UJUJC82AG",
      "message": "That doc is more helpful :smile:",
      "time": "14:10",
      "timestamp": "1580508611.277200",
      "is_reply": true
    },
    {
      "sender": "Jonathan Shih",
      "user_id": "UGJD45BCP",
      "message": "my internet is not fast enough to debug this lol. will look at it later if you guys haven’t figured it out yet",
      "time": "14:13",
      "timestamp": "1580508809.277400",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "I think if you just want to run this one test you can do `make run-golden-test TEST_NAMES=multiflow_v2_binary_adp`",
      "time": "14:16",
      "timestamp": "1580508961.277600",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "```[2020-01-31 14:16:12,010: ERROR/ForkPoolWorker-4] Traceback (most recent call last):\n  File \"/Users/efriis/instabase/distributed-tasks/celery/app-tasks/build/py/instabase/flow/v2/flow_map_lib.py\", line 251, in _run_flow\n    result = _handle_input_file(bin_reader, flow_in_zip, full_path, ctx)\n  File \"/Users/efriis/instabase/distributed-tasks/celery/app-tasks/build/py/instabase/flow/v2/flow_map_lib.py\", line 133, in _handle_input_file\n    overrides, output_root_folder)\n  File \"/Users/efriis/instabase/distributed-tasks/celery/app-tasks/build/py/instabase/flow/v2/mappers/mapper_fns.py\", line 294, in run_steps\n    record_output, ib_err = future.result(timeout=timeout)\n  File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/concurrent/futures/_base.py\", line 432, in result\n    return self.__get_result()\n  File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/concurrent/futures/_base.py\", line 384, in __get_result\n    raise self._exception\n  File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/concurrent/futures/thread.py\", line 56, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"/Users/efriis/instabase/distributed-tasks/celery/app-tasks/build/py/instabase/flow/v2/mappers/mapper_fns.py\", line 73, in _run\n    return apply_refiner.run(step_ctx)\n  File \"/Users/efriis/instabase/distributed-tasks/celery/app-tasks/build/py/instabase/flow/v2/mappers/step/apply_refiner.py\", line 175, in run\n    _write_logs(logger, resp.extract_resps)\nAttributeError: 'NoneType' object has no attribute 'extract_resps'```",
      "time": "14:16",
      "timestamp": "1580508996.277800",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "oh @Erick did that work for you becuase you're not on nginx? local breaks for me now",
      "time": "14:17",
      "timestamp": "1580509050.278000",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "do you see any other logs?",
      "time": "14:18",
      "timestamp": "1580509084.278200",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "i'm getting this error trying to run goldens because of nginx\n```The following tests failed:\n Test_name: multiflow_v2_binary_adp.\n Error={\"error\": \"Dispatching request failed: HTTPSConnectionPool(host='localhost', port=443): Max retries exceeded with url: /api/v1/flow/run_binary_async (Caused by SSLError(SSLError(\\\"bad handshake: Error([('SSL routines', 'tls_process_server_certificate', 'certificate verify failed')])\\\")))\"} \nSee the output results: /Users/lydia/Instabase/instabase/webserver/api-server-apps/build/golden-test/py/tmp/golden_results_1580509002.718982.txt```",
      "time": "14:18",
      "timestamp": "1580509117.278400",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "and i can't run it from the flow ui because it's currently broken :sob:",
      "time": "14:19",
      "timestamp": "1580509150.278600",
      "is_reply": true
    },
    {
      "sender": "Erick",
      "user_id": "ULQK30Z7V",
      "message": "Oh sad. Want to zoom?",
      "time": "14:19",
      "timestamp": "1580509185.278800",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "oh! i see why it's broken, the flowbin opens in flow/edit instead of flow/run - did we change that recently?",
      "time": "14:19",
      "timestamp": "1580509198.279000",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "i got it working my opening it a different way",
      "time": "14:20",
      "timestamp": "1580509207.279200",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "I think you tack on LEGACY=true when running the goldens, that should help you get around nginx issues",
      "time": "14:27",
      "timestamp": "1580509637.279500",
      "is_reply": true
    },
    {
      "sender": "will",
      "user_id": "UJUJC82AG",
      "message": "A long term fix is probably to allow self signed/“insecure” certs during local testing.",
      "time": "14:27",
      "timestamp": "1580509678.279900",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "ok looks like the offending commit is https://github.com/instabase/instabase/pull/12479 cc @Chetan",
      "time": "14:49",
      "timestamp": "1580510946.280100",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "perhaps something went poorly in the refactor?",
      "time": "14:49",
      "timestamp": "1580510961.280300",
      "is_reply": true
    },
    {
      "sender": "lydia",
      "user_id": "UJK4LKYSJ",
      "message": "merged jan 28 7pm PST for what it's worth",
      "time": "14:50",
      "timestamp": "1580511023.280500",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "oops. i’ve broken so many things with that PR o.o",
      "time": "15:01",
      "timestamp": "1580511708.280700",
      "is_reply": true
    },
    {
      "sender": "will",
      "user_id": "UJUJC82AG",
      "message": "Experimenting fearlessly! I like it! :slightly_smiling_face:",
      "time": "15:02",
      "timestamp": "1580511729.280900",
      "is_reply": true
    },
    {
      "sender": "Heymian",
      "user_id": "UADQ9V8PK",
      "message": "thanks for helping with the triage!",
      "time": "15:16",
      "timestamp": "1580512587.281200",
      "is_reply": true
    },
    {
      "sender": "Chetan",
      "user_id": "UE3TJAR9U",
      "message": "fixed i’m pretty sure with this PR: https://github.com/instabase/instabase/pull/12555\ngoldens still failing — different error though: https://jenkins.instabase.com/job/dogfood-golden-tests/52/execution/node/16/log/\n\ni can help investigate monday",
      "time": "19:42",
      "timestamp": "1580528557.285400",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2020-01-31.json",
    "message_count": 35,
    "start_time": "1580490289.263600",
    "end_time": "1580528557.285400",
    "is_thread": true
  }
}