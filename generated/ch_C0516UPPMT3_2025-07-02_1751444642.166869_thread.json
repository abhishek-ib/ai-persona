{
  "id": "ch_C0516UPPMT3_2025-07-02_1751444642.166869_thread",
  "type": "channel",
  "channel_name": "aihub-feedback",
  "conversation_type": "thread",
  "participants": [
    "ayesha.ali",
    "shreya.rajput",
    "Serena",
    "Jacky Chen"
  ],
  "messages": [
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "deleting by app name is supposed to delete all app versions, but it didn't work properly (see https://github.com/instabase/instabase/pull/71555 and https://github.com/instabase/instabase/pull/71554)\n\nwe previously suggested (https://instabase.slack.com/archives/C0516UPPMT3/p1751312916990319?thread_ts=1751311602.538309&cid=C0516UPPMT3) deleting specific app versions by id (not app name), so that's what shreya did",
      "time": "01:24",
      "timestamp": "1751444642.166869",
      "is_reply": false
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "@ayesha.ali thanks for checking! at least we know that idea is non-viable :smiling_face_with_tear:\n\n@shreya.rajput if you're concerned about the run disappearing, you can also export the run results into a csv or excel\n\nit seems there's no easy way to convert this run into a ground truth set though, we can discuss more during our call today",
      "time": "01:29",
      "timestamp": "1751444985.152429",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "@Jacky Chen suggested manually changing the associated `deployed_solution_id` for the deployment run in the db to an existing app version's id\n\njacky and i are not sure whether this will break anything else though\n\n@ayesha.ali could you try this for your aihub-uat deployment run that's associated with a deleted app version?\n• you'll need to request TPAM access to aihub-uat though - see https://instabase.atlassian.net/wiki/spaces/ENG/pages/2582773768/Database+-+Runbook+Troubleshooting#Connecting-to-a-SaaS-Database\n• so it may be easier to try this in your crafting environment?\n• if this manual db change doesn't break anything, are you able to create a gt set using this deployment run?",
      "time": "07:27",
      "timestamp": "1751466426.540209",
      "is_reply": true
    },
    {
      "sender": "Jacky Chen",
      "user_id": "U037KQU966S",
      "message": "Quick recap from this morning's sync with Serena on this issue:\n1. (immediately) To unblock Shreya, Serena/Ayesha will be testing updating backend to point a run to a different existing app version. \n    a. There might be other workarounds but this one seems most intuitive and we will see if it works.\n    b. CC @ayesha.ali keep us posted in your testing as Serena suggested above\n2. (minor) Suspicious deletion behavior: \n    a. The deletion call itself seems to be very risky and have some weird behaviors.\n    b. We may wanna figure out why the API deleted all app versions from me and Ayesha's tests but kept some versions in Jet's test and Shreya's work.\n        i. note that just verified with Shreya that she only did 7-8 deletion calls but those calls deleted 60+ versions. It's still very unexpected.",
      "time": "08:04",
      "timestamp": "1751468653.074799",
      "is_reply": true
    },
    {
      "sender": "ayesha.ali",
      "user_id": "U058ZCMJ28L",
      "message": "to the second point, i think if the aihub project still exists, deleting w/ the app id deletes all app versions, which is what happened in my testing (possible for jacky as well), but when it no longer exists it'll only delete the version matching the given app id\n\ni'll investigate the first point on my crafting environment",
      "time": "08:31",
      "timestamp": "1751470305.047699",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i see 15 deletion calls (https://nationwide.aihub.instabase.com/grafana/explore?schemaVersion=1&panes=%7B%22r9x%22:%7B%22datasource%22:%22loki%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bcontainer%3D%5C%22api-server%5C%22%7D%20%7C%3D%20%60DELETE%20/api/v2/aihub/build/projects/app%60%20%7C%3D%20%60201%60%22,%22queryType%22:%22range%22,%22datasource%22:%7B%22type%22:%22loki%22,%22uid%22:%22loki%22%7D,%22editorMode%22:%22builder%22,%22direction%22:%22backward%22%7D%5D,%22range%22:%7B%22from%22:%221751313600000%22,%22to%22:%221751342399000%22%7D,%22panelsState%22:%7B%22logs%22:%7B%22visualisationType%22:%22logs%22%7D%7D%7D%7D&orgId=1) from Shreya on Monday\n\nas Ayesha said, i think that if the deleted app id is currently associated with the Build project, all app versions in that lineage will be deleted\n\nso i assume 1 of the 15 deletion calls was for an app id associated with the Build project",
      "time": "08:42",
      "timestamp": "1751470963.269499",
      "is_reply": true
    },
    {
      "sender": "ayesha.ali",
      "user_id": "U058ZCMJ28L",
      "message": "actually looking into the second point, even when the project is deleted, we do a soft delete that still preserves the connection between the project and its deployed solutions so all app versions will still be deleted :((\n\ndue to this, the steps i took to recreate the issue and get the ground truth set created:\nstep 1: create build project 1 --> create app 1 --> create deployment 1 --> run deployment 1 w/ job_id `1234`  and make some changes in human review\nstep 2: delete app (this removes deployed solutions/deployments, but job_id `1234` still exists in the job table)\nstep 3: create build project 2 --> create app 2 w/ deployed_solution_id `abcd`  in repo `xyz`\n*step 4: (DB manipulation) insert into deployed_solution_jobs: deployed_solution_id `abcd` , job_id `1234`, repo `xyz`*\nstep 5: (app run will now appear in UI), create ground truth set from app run in UI, saw that human review changes were still there\n• initially even if the app schema of the new app is different than what's in the original app run, the gt set will be marked as completed not outdated\nfurther tests were to\n• edit values of the ground truth set\n• run an accuracy test\n• create a new app version, see that gt set was marked outdated, and update it \n    ◦ unfortunately this doesn't work, the human review change are overwritten, i will need to see what exactly in our preservation logic is causing this to break b/c my class/field names are the same in app 1 and app 2",
      "time": "10:00",
      "timestamp": "1751475623.104519",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "thank you for confirming and testing further beyond gt set creation!\n\n@Jacky Chen is this enough information for you to make the manual db changes in the nationwide env?\n\n@shreya.rajput fyi that after the gt set is created, you shouldn't update the gt set even if it has outdated status",
      "time": "10:57",
      "timestamp": "1751479049.086329",
      "is_reply": true
    },
    {
      "sender": "Jacky Chen",
      "user_id": "U037KQU966S",
      "message": "thank you @ayesha.ali ! So eventually we can work around this by inserting a row in *deployed_solution_jobs (deployed_solution_id `abcd` , job_id `1234`, repo `xyz`* )\nNot updating an existing row? assuming there would be 2 rows with this job ID after inserting one with none exist solution ID and other with the new solution ID?",
      "time": "11:08",
      "timestamp": "1751479717.275729",
      "is_reply": true
    },
    {
      "sender": "ayesha.ali",
      "user_id": "U058ZCMJ28L",
      "message": "yeah so the *deployed_solution_jobs* table is a join table between the deployed_solutions and jobs table, when an app is deleted, we remove that link all together (so no row w/ a non-existent solution id and a job id) but the job still exist, so in this situation we need to insert a new link",
      "time": "12:36",
      "timestamp": "1751484972.262739",
      "is_reply": true
    },
    {
      "sender": "shreya.rajput",
      "user_id": "U0879DJ1V0W",
      "message": "Hi All, Happy to verify that @Jacky Chen has been able to restore the run back into our app. Appreciate all the help!",
      "time": "14:51",
      "timestamp": "1751493108.801339",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C0516UPPMT3",
    "channel_name": "aihub-feedback",
    "date_file": "2025-07-02.json",
    "message_count": 11,
    "start_time": "1751444642.166869",
    "end_time": "1751493108.801339",
    "is_thread": true
  }
}