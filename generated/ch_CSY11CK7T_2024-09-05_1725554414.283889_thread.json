{
  "id": "ch_CSY11CK7T_2024-09-05_1725554414.283889_thread",
  "type": "channel",
  "channel_name": "discuss-frontend",
  "conversation_type": "thread",
  "participants": [
    "Xindi Xu",
    "Cody Boggs",
    "Udit",
    "Ashwin",
    "tony.shi",
    "Weiming Wu",
    "sean.donohoe",
    "Aayush",
    "Serena"
  ],
  "messages": [
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Has our Cypress sandbox been slow since yesterday? I see a couple runs failed because of this slowness:\n1. deleting old projects is taking a while in these runs: 13647 (https://cloud.cypress.io/projects/cfhedy/runs/13647/overview/ee86097d-79be-433e-9843-84ece15ec82b?roarHideRunsWithDiffGroupsAndTags=1), 13629 (https://cloud.cypress.io/projects/cfhedy/runs/13629/overview/615329f5-3cea-4542-9302-7819222b530f?roarHideRunsWithDiffGroupsAndTags=1)\n2. get bulk status (or some other related endpoint) is taking a while, so the UI for run status is missing:  13646 (https://cloud.cypress.io/projects/cfhedy/runs/13646/overview/84c4d1b6-66e6-416c-9cee-a5a15928c661/replay?att=1&pc=log-https%3A%2F%2Fcrafting-cyp--pr-62198-cypress-instabase.instabase.site.sandboxes.run-5154__command-logs&roarHideRunsWithDiffGroupsAndTags=1&ts=1725553240231.8)",
      "time": "09:40",
      "timestamp": "1725554414.283889",
      "is_reply": false
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "<!subteam^S07855GV3GV>",
      "time": "09:40",
      "timestamp": "1725554423.767089",
      "is_reply": true
    },
    {
      "sender": "Aayush",
      "user_id": "U01594ZKULX",
      "message": "just updated the members <!subteam^S07855GV3GV>",
      "time": "09:41",
      "timestamp": "1725554490.280029",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "going to delete my sandboxes and try again :crossed_fingers:",
      "time": "09:44",
      "timestamp": "1725554644.377179",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "some of my PRs have been constantly failing, i think i may have to delete the sandboxes as well",
      "time": "09:44",
      "timestamp": "1725554681.433659",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "oops thanks for updating the cypress-on-call tag! @Aayush",
      "time": "09:49",
      "timestamp": "1725554953.253679",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i’m not able to see any Cypress runs on Cypress dashboard rn - it always redirects me to this page\n\nare you guys seeing the same thing?",
      "time": "09:50",
      "timestamp": "1725555010.652509",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": ":thinking_face: i can see the test results. maybe try clearing the cache for the site?",
      "time": "09:51",
      "timestamp": "1725555067.493239",
      "is_reply": true
    },
    {
      "sender": "Weiming Wu",
      "user_id": "U03DZ9Y4MC2",
      "message": "I'm also noticing like a hundred runs of `cypress-run-app` :grimacing:",
      "time": "09:52",
      "timestamp": "1725555121.185469",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i logged out and logged back in, i can see the cypress runs now",
      "time": "09:52",
      "timestamp": "1725555158.525739",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Are we cleaning up these runs within Cypress tests and were clean up failed previously?",
      "time": "09:53",
      "timestamp": "1725555223.249899",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "there’s no way to delete app runs, so it’s not possible to clean up these runs",
      "time": "09:54",
      "timestamp": "1725555253.901409",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i’m confused why there are so many runs at 0% progress though",
      "time": "09:54",
      "timestamp": "1725555264.978089",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "gotcha. It makes me wonder if we should reconsider wiping and restoring database to a clean snapshot regularly",
      "time": "09:55",
      "timestamp": "1725555303.570679",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "would that wipe all existing apps, deployments and runs?",
      "time": "09:56",
      "timestamp": "1725555390.220729",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "yes it would - it’s fine to delete runs, but not fine to delete apps/deployments\n\nwe would need to do a limited cleanup of the db, not literally delete everything",
      "time": "09:57",
      "timestamp": "1725555439.833649",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "I think restoring snapshot would, but we can also try cloning certain tables",
      "time": "09:57",
      "timestamp": "1725555457.078989",
      "is_reply": true
    },
    {
      "sender": "Weiming Wu",
      "user_id": "U03DZ9Y4MC2",
      "message": "Yea, the consequence of resetting to a snapshot is that we also need to remember to update teh snapshot to accommodate new test setups",
      "time": "09:57",
      "timestamp": "1725555457.189479",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "yah that would be perfect, i was concerned if it would delete apps and deployments",
      "time": "09:57",
      "timestamp": "1725555463.882149",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "otherwise tests that are more downstream kind of have to do every step beforehand within cypress just to test them :sweat_smile:",
      "time": "09:58",
      "timestamp": "1725555494.976929",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "it'd be great to have a script to automate this and run that script after we clean up db",
      "time": "09:59",
      "timestamp": "1725555546.394309",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "`view-home-page.spec.ts` is still failing here (https://cloud.cypress.io/projects/cfhedy/runs/13653/overview/52de853b-d039-484c-bc97-36f551095327?roarHideRunsWithDiffGroupsAndTags=1) because deleting project takes a while. I'll ask for force merging for now",
      "time": "10:03",
      "timestamp": "1725555824.131249",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i’m curious whether deleting all the in-progress runs for `cypress-run-app` and `cypress-human-review` will at least make `ViewApp/run-app.spec.ts` and the Human Review Cypress tests more stable",
      "time": "10:30",
      "timestamp": "1725557435.124649",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "`cypress-human-review` is in the same situation as `cypress-run-app` with many runs at 0% progress",
      "time": "10:31",
      "timestamp": "1725557466.599789",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "is the sandbox just not running any apps successfully, how did it get into this state?",
      "time": "10:31",
      "timestamp": "1725557506.656009",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "also i’m concerned about these 2 failed runs that took 16 hours :scream:",
      "time": "10:31",
      "timestamp": "1725557507.317159",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "> is the sandbox just not running any apps successfully, how did it get into this state?\nyeah i think you’re right, i’m still trying to figure out what’s happening in the logs",
      "time": "10:32",
      "timestamp": "1725557526.286559",
      "is_reply": true
    },
    {
      "sender": "Weiming Wu",
      "user_id": "U03DZ9Y4MC2",
      "message": "I think I saw a few of my CI runs fail because of things like file uploads in Build take too long, but that could be a consequence of hundreds of in-progress app runs",
      "time": "10:33",
      "timestamp": "1725557587.698669",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "uh oh seems that celery-app-tasks is in a crash loop bc of a dependency issue :notlikeblob:",
      "time": "10:33",
      "timestamp": "1725557597.287639",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "if celery-app-tasks is not working, many things (including digitization in Build) will break",
      "time": "10:33",
      "timestamp": "1725557608.842279",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "this has already been fixed on master https://instabase.slack.com/archives/CCY413CSU/p1725520274092879?thread_ts=1725509432.847919&cid=CCY413CSU, so i’ll kick off a crafting-cyp deployment to include this fix",
      "time": "10:34",
      "timestamp": "1725557658.457979",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "dang i see several failed upgrades this morning - @sean.donohoe is it worth trying again? do you know why the upgrade this morning failed?",
      "time": "10:36",
      "timestamp": "1725557780.623289",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "ah i see, there was a TLS handshake timeout in the build for `search-tservice` :disappointed: https://jenkins.instabase.com/job/service-builder/job/build-service/179110/console",
      "time": "10:37",
      "timestamp": "1725557832.368649",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i clicked “Update” in ICC, just to see if it gets farther than the deployment earlier today\n\ni forgot to set any advanced args - hopefully that doesn’t break anything? @sean.donohoe",
      "time": "10:40",
      "timestamp": "1725558036.923739",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "Is this working now as expected?",
      "time": "12:01",
      "timestamp": "1725562919.851329",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "the upgrade failed bc bazel failed to install dependencies when building control-plane https://jenkins.instabase.com/job/service-builder/job/build-service/179400/console :disappointed:\n\n@sean.donohoe any suggestions for what to try next?",
      "time": "12:07",
      "timestamp": "1725563255.910049",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "this is quite concerning\n```dial tcp: lookup go.opentelemetry.io (http://go.opentelemetry.io) on 10.200.0.2:53: no such host```\nI suspect it's either an outage with that site, that the version of that library we're using is no longer available, or that something in our build infra is restricting network requests",
      "time": "12:22",
      "timestamp": "1725564164.001179",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "@Ashwin / @Cody Boggs would you guys be able to help me confirm/deny whether my statement above is correct, when you have a moment?",
      "time": "12:29",
      "timestamp": "1725564568.584299",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Hmmm\nMy money says 'transient DNS issue' but I don't know that for sure",
      "time": "12:36",
      "timestamp": "1725564989.997059",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "dank, I'll try running an upgrade again then :crossed_fingers:",
      "time": "12:39",
      "timestamp": "1725565198.076929",
      "is_reply": true
    },
    {
      "sender": "Ashwin",
      "user_id": "U02R2LS2TPS",
      "message": "Ya I dont think we're doing anything to block outbound network requests unless that port is brand new, my money is also on transient issue",
      "time": "12:43",
      "timestamp": "1725565418.728499",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "nooo another bazel go dependency TLS handshake timeout (https://jenkins.instabase.com/job/service-builder/job/build-service/180338/console) :sob: , this time in the build for post-install-action-ml-studio-config-setup, which isn’t even necessary in this environment :cry:\n``` Error in fail: failed to fetch org_golang_x_text: fetch_repo: golang.org/x/text@v0.17.0: unrecognized import path \"golang.org/x/text\": https fetch: Get \"https://golang.org/x/text?go-get=1\": net/http: TLS handshake timeout\n13:53:09  ERROR: Evaluation of subquery \"deps(//tools/onprem/post-install-action-ml-studio-config-setup/src/go/src:main)\" failed (did you want to use --keep_going?): preloading transitive closure failed: no such package '@org_golang_x_text//unicode/norm': failed to fetch org_golang_x_text: fetch_repo: golang.org/x/text@v0.17.0: unrecognized import path \"golang.org/x/text\": https fetch: Get \"https://golang.org/x/text?go-get=1\": net/http: TLS handshake timeout```",
      "time": "14:28",
      "timestamp": "1725571694.684149",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "if this is supposed to be a transient issue, do we know why this error is occurring more often than before?",
      "time": "14:29",
      "timestamp": "1725571790.750339",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "or maybe it’s just happening more often for crafting-cyp than before\n\ni know we’ve seen these errors on a bunch of deployments in recent weeks (ex: 1 (https://instabase.slack.com/archives/C041XGH39UN/p1724944832107879?thread_ts=1724944626.198769&cid=C041XGH39UN), 2 (https://instabase.slack.com/archives/CCY413CSU/p1724368762559419?thread_ts=1724366398.209659&cid=CCY413CSU))",
      "time": "14:37",
      "timestamp": "1725572224.026239",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "i see several options - wdyt? @sean.donohoe\n1. try to deploy the old images from the last time crafting-cyp was successfully upgraded\n2. click “Upgrade” again and hope that the transient errors _really_ don’t happen this time :smiling_face_with_tear:",
      "time": "14:38",
      "timestamp": "1725572318.823679",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "given the infra issues, i’m going to temporarily make Cypress CI a no-op (see PR (https://github.com/instabase/instabase/pull/62254))\n\nexisting PRs will still be blocked, so if you need to urgently merge a PR, please ask an EM to force-merge!",
      "time": "14:52",
      "timestamp": "1725573121.308629",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "hey sorry, was addressing some other broken stuff -- I'm not sure why we're seeing those i/o timeouts still, we have the entire jenkins host available per image build (also it's super weird that we were seeing IP failures earlier, which makes me think something's up with at least one of the jenkins executors)",
      "time": "15:13",
      "timestamp": "1725574390.641629",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "@Cody Boggs / @Aaron Tami any issues with me bouncing the existing jenkins executors?",
      "time": "15:13",
      "timestamp": "1725574409.955889",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "That’s fine, I have a script for that if you want",
      "time": "15:14",
      "timestamp": "1725574452.184549",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "lol nah I'll just manually take them down",
      "time": "15:14",
      "timestamp": "1725574466.069249",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "kk I just bounced the jenkins workers and am going to try another deploy",
      "time": "15:18",
      "timestamp": "1725574728.811669",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "chairman wow, I think that did it (all the image builds passed this time at least)",
      "time": "16:10",
      "timestamp": "1725577802.242449",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "crafting-cyp is back! i see app runs with some progress",
      "time": "16:27",
      "timestamp": "1725578826.496599",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "phew",
      "time": "16:27",
      "timestamp": "1725578860.396259",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": "thank goodness, that was a very odd bug",
      "time": "16:27",
      "timestamp": "1725578873.386829",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "@tony.shi is there a way to clear the celery-app-tasks job queue? there are a loooot of runs that we should just cancel",
      "time": "16:28",
      "timestamp": "1725578899.507239",
      "is_reply": true
    },
    {
      "sender": "tony.shi",
      "user_id": "U03R8QN7VQA",
      "message": "Something like this endpoint perhaps?\n\napi/v1/jobs/cancel_all",
      "time": "16:29",
      "timestamp": "1725578971.515629",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "@sean.donohoe thank you for helping promptly as always!\n\ni’ll put up a PR to revert my change of making Cypress CI a no-op",
      "time": "16:29",
      "timestamp": "1725578996.459589",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "@tony.shi thanks! i called the api, and it worked!",
      "time": "16:35",
      "timestamp": "1725579329.685599",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "sorry for the thrash, all! here’s the PR (https://github.com/instabase/instabase/pull/62257) to revert making Cypress CI a no-op",
      "time": "16:36",
      "timestamp": "1725579399.005959",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "CSY11CK7T",
    "channel_name": "discuss-frontend",
    "date_file": "2024-09-05.json",
    "message_count": 60,
    "start_time": "1725554414.283889",
    "end_time": "1725579399.005959",
    "is_thread": true
  }
}