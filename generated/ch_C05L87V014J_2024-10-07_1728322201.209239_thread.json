{
  "id": "ch_C05L87V014J_2024-10-07_1728322201.209239_thread",
  "type": "channel",
  "channel_name": "ask-crafting",
  "conversation_type": "thread",
  "participants": [
    "Paul H",
    "mfichman",
    "Udit",
    "Jessica",
    "sean.donohoe"
  ],
  "messages": [
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "My crafting sandbox's api-server and apps-server have status unknown suddenly and restarting the sandbox or `workspace setup` is not fixing it. I just see a white screen when I open the link to the sandbox. Any idea whats going on?",
      "time": "10:30",
      "timestamp": "1728322201.209239",
      "is_reply": false
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "Have you tried pulling the latest master and restarting the sandbox?",
      "time": "10:54",
      "timestamp": "1728323691.741559",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "If that doesn’t work, I’m curious to see the logs for those services",
      "time": "10:55",
      "timestamp": "1728323706.544969",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "I'll try this, although I last rebased a few hours ago so its quite recent",
      "time": "10:56",
      "timestamp": "1728323768.923729",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "I’ve ssh’d into the box and I think I know what the issue is. Do you mind if I make some modifications @Udit?",
      "time": "11:07",
      "timestamp": "1728324451.766379",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "The `udit-ib-crafting` box, right?",
      "time": "11:07",
      "timestamp": "1728324464.376749",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "yes",
      "time": "11:09",
      "timestamp": "1728324558.019619",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "go ahead!",
      "time": "11:09",
      "timestamp": "1728324559.612269",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "a rebase did not fix it",
      "time": "11:09",
      "timestamp": "1728324565.125799",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "Okay, I tried and it did not work =(\nIt also seems like Sean is on vacation atm",
      "time": "11:33",
      "timestamp": "1728325986.395119",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "Can you try spinning up a new sandbox using the `frontend` template again?",
      "time": "11:33",
      "timestamp": "1728325986.607589",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "yah i'll try making a new one",
      "time": "11:35",
      "timestamp": "1728326159.347819",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "Actually yeah, my sandbox is now having that issue after pulling master",
      "time": "12:19",
      "timestamp": "1728328764.606799",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "~Even when I checkout my old branch, it still a white screen~ huh maybe not",
      "time": "12:19",
      "timestamp": "1728328775.066909",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "I’m digging into this =(",
      "time": "12:19",
      "timestamp": "1728328779.621359",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "Thank you Paul!",
      "time": "12:19",
      "timestamp": "1728328791.571289",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "@Udit do you mind if I edit your box again?",
      "time": "12:36",
      "timestamp": "1728329801.721959",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "go ahead!!",
      "time": "12:38",
      "timestamp": "1728329907.228929",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "Okay, @Udit your sandbox should be working again (make sure you do a hard refresh). You’ll need to rebase your branch off this commit `4bc753a668908c199f36c26d4f1544cc2b30223b` because any later and it’ll break.",
      "time": "12:48",
      "timestamp": "1728330508.947529",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "@mfichman it seems like the PR https://github.com/instabase/instabase/pull/62784 has broken the default crafting dev setup. Have we updated the crafting template (?) to use the new dev ports for nginx?\n```2024/10/07 19:43:15 [crit] 12#12: *1 SSL_do_handshake() failed (SSL: error:0A0000C6:SSL routines::packet length too long error:0A000139:SSL routines::record layer failure) while SSL handshaking to upstream, client: 10.253.24.133, server: , request: \"GET /static/output/monaco.bundle.js?v=1728288312.981270811 HTTP/1.1\", upstream: \"https://169.254.16.1:8081/static/output/monaco.bundle.js?v=1728288312.981270811\", host: \"crafting-aihub--udit-ib-crafting-instabase.instabase.site.sandboxes.run\"```",
      "time": "12:51",
      "timestamp": "1728330693.756679",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "@sean.donohoe sorry to ping you on vacation but we might need your input here - is it easy to update the crafting template to match Matt's PR or should we just revert the PR for now?",
      "time": "13:07",
      "timestamp": "1728331656.435179",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "I think everyone's dev setup is going to br broken until we fix this",
      "time": "13:08",
      "timestamp": "1728331689.486419",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Sorry all, was in an interview. How are you accessing your sandbox @Udit?\n\na) Tunnel port 443 from the sandbox + navigate browser to https://localhost on your laptop\n\nOr\n\nb) Navigate browser to https://crafting-aihub--udit-ib-crafting-instabase.instabase.site.sandboxes.run",
      "time": "13:13",
      "timestamp": "1728331983.903889",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "I always do b, go straight to the url from browser",
      "time": "13:17",
      "timestamp": "1728332273.031769",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "OK, got it. Yes, I think the traffic interception port needs to change from 8091/https to 80/http.",
      "time": "13:19",
      "timestamp": "1728332350.448019",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "When you start interception, do you use `workspace` or the crafting UI @Udit?",
      "time": "13:19",
      "timestamp": "1728332384.485229",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "usual workflow is resuming sandbox from the crafting UI, and then on my local VSCode, it prompts me to reset the ssh connection after restarting the sandbox!",
      "time": "13:20",
      "timestamp": "1728332434.892619",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "OK, so someone else must have set up kubernetes interception for you then (I figure)",
      "time": "13:23",
      "timestamp": "1728332619.484379",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "It was probably Sean",
      "time": "13:24",
      "timestamp": "1728332649.997729",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "It looks like you're not on a branch right now -- is that intentional?",
      "time": "13:24",
      "timestamp": "1728332665.043719",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Ah I see. You're using the `frontend` template -- I thought most folks used `ibdev`. Let me take a look. We can roll back my PR by the way.",
      "time": "13:25",
      "timestamp": "1728332759.326809",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "https://github.com/instabase/instabase/pull/63569 reverted",
      "time": "13:28",
      "timestamp": "1728332919.782699",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": ">  It looks like you’re not on a branch right now -- is that intentional?\nYeah, that was me. I checked out a commit right before your original PR for testing purposes",
      "time": "13:30",
      "timestamp": "1728333059.132189",
      "is_reply": true
    },
    {
      "sender": "Paul H",
      "user_id": "U011UPRAPNV",
      "message": "Thanks for handling this so quickly @mfichman!",
      "time": "13:31",
      "timestamp": "1728333069.819439",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "Ah Sean did tell me that the frontend template was deprecated, I made a new one recently using the ib-dev one. @Udit probably a good idea to do that to avoid stuff like this in the future",
      "time": "13:31",
      "timestamp": "1728333109.735119",
      "is_reply": true
    },
    {
      "sender": "Jessica",
      "user_id": "UDEF3M2NP",
      "message": "If you just bite the bullet and do it now maybe we can avoid the rollback. You'd probably get your environment back sooner too",
      "time": "13:32",
      "timestamp": "1728333132.218989",
      "is_reply": true
    },
    {
      "sender": "Udit",
      "user_id": "U03M519DVKR",
      "message": "I'll make a new one using ib-dev as well then. Seems like Matt already reverted his change for the timebeing though.",
      "time": "13:33",
      "timestamp": "1728333206.978389",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Yes, I reverted it. I figured that PR might be a little rocky; I'll iterate and try again. Thanks all!",
      "time": "13:37",
      "timestamp": "1728333457.870869",
      "is_reply": true
    },
    {
      "sender": "sean.donohoe",
      "user_id": "U04JYSDMV63",
      "message": ":wave: apologies for the delayed response, I didn’t see the tag earlier! I’m still reading through everything but some clarification points:\n\n• Updating the templates is super easy, you can do it through the crafting UI. It will, however, update everyone’s sandboxes, so for non-emergency situations we usually clone the ibdev template for making and testing changes\n• All sandboxes are configured to run ‘workspace setup’ when they are created and resumed — this configures interception, and reads configuration from workspace environment variables (so if you enable a service and reboot your sandbox, the sandbox will come back up with the intercepted service running)\n• The frontend template is indeed deprecated, however it is almost identical to the ibdev template (it’s basically ibdev with webserver service interception enabled by default). Whenever that’s been acting weird in the past I start by looking at what’s different between the ibdev and frontend templates, as 99% of the time it’s the frontend template needing to be updated :p",
      "time": "14:44",
      "timestamp": "1728337448.040309",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C05L87V014J",
    "channel_name": "ask-crafting",
    "date_file": "2024-10-07.json",
    "message_count": 39,
    "start_time": "1728322201.209239",
    "end_time": "1728337448.040309",
    "is_thread": true
  }
}