{
  "id": "ch_C05L87V014J_2025-07-02_1751488375.059369_thread",
  "type": "channel",
  "channel_name": "ask-crafting",
  "conversation_type": "thread",
  "participants": [
    "mfichman",
    "Anil"
  ],
  "messages": [
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": "I was trying to figure out why crafting sandboxes end up consuming 200GB+ of space.\nWhen you run out of space, the box is bricked and you might have to start over\nWe run docker system prune in cron\n\nOne possible reason checking Matt’s sandbox is docker system prune get stuck?\nOn @mfichman’s sandbox - prune seems to be running for 8hrs now\n\ncs/mfichman❯ ps aux|grep prune\nowner     457539  0.0  0.0 3094312 21604 ?       Sl   11:59   0:00 docker system prune -f\nowner    3647260  0.0  0.0   6628  2148 pts/2    S+   20:29   0:00 grep prune\ncs/mfichman❯ ps -p 457539 -o lstart=\nWed Jul  2 11:59:59 2025\ncs/mfichman❯ ps -p 457539 -o pid,etime,lstart,cmd\n    PID     ELAPSED                  STARTED CMD\n 457539    08:30:46 Wed Jul  2 11:59:59 2025 docker system prune -f\nsys\t0m0.000s\ncs/mfichman❯ date\nWed Jul  2 08:30:59 PM UTC 2025",
      "time": "13:32",
      "timestamp": "1751488375.059369",
      "is_reply": false
    },
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": "The snapshot is very very big\n```root@dev:/var/lib/docker/containerd/daemon/io.containerd.snapshotter.v1.overlayfs/snapshots# ls\n10\t111868\t114977\t118284\t12005\t122790\t125325\t131808\t131934\t132349\t142834\t143145\t143254\t143390\t143525\t145866\t145929\t145981\t146029\t146077\t15187  1554   25780  29024  55\t   8491\n105793\t111870\t114978\t118285\t120198\t122791\t125331\t131809\t131935\t132350\t142835\t143148\t143256\t143391\t143528\t145867\t145932\t145982\t146030\t146078\t15188  1555   25781  29025  6\t   8492\n105794\t1119\t115364\t118286\t120200\t122792\t129372\t131810\t131939\t132351\t142836\t143149\t143257\t143393\t143529\t145868\t145933\t145983\t146031\t146079\t15189  17751  25782  29026  63233  8493\n105795\t1123\t115677\t118287\t120201\t123292\t129582\t131811\t131940\t132352\t142837\t143151\t143259\t143394\t143530\t145869\t145934\t145984\t146032\t146080\t15190  17752  25783  29027  63234  8494\n105796\t1128\t115678\t118289\t120203\t123293\t129587\t131812\t131943\t132353\t142838\t143152\t143261\t143396\t143531\t145870\t145935\t145985\t146033\t146081\t15191  17753  25784  29028  63235  8495\n106506\t11300\t115679\t118290\t121390\t123294\t129928\t131813\t131944\t132354\t142839\t143153\t143263\t143397\t143532\t145871\t145936\t145986\t146034\t146082\t15192  17754  25785  29029  63238  8496\n106511\t113296\t115680\t118291\t121889\t123295\t13\t131814\t131948\t132355\t142840\t143161\t143264\t143398\t143533\t145872\t145937\t145987\t146035\t146083\t15193  17755  25786  29030  63239  8497\n106518\t113298\t115686\t118292\t121913\t123296\t130023\t131815\t131949\t132356\t142841\t143165\t143272\t143400\t143534\t145876\t145938\t145988\t146036\t146084\t15194  17756  25813  29031  63240  8498\n106524\t113301\t115687\t118293\t121914\t123297\t130276\t131816\t131952\t132361\t142842\t143169\t143273\t143401\t143535\t145877\t145939\t145989\t146037\t146085\t15195  17757  25814  29032  63241  8499\n107378\t113303\t115688\t118294\t121915\t123298\t130277\t131817\t131953\t132362\t142843\t143175\t143274\t143423\t143536\t145878\t145940\t145990\t146038\t146086\t15196  17758  25815  29033  63244  8500\n10939\t113304\t115689\t118295\t121916\t123307\t130291\t131848\t131957\t132363\t142844\t143176\t143276\t143424\t143537\t145881\t145941\t145991\t146039\t146087\t15199  17759  25816  29034  63245  8501\n10942\t113305\t115695\t118296\t121917\t123308\t130294\t131849\t131958\t132380\t142944\t143178\t143282\t143425\t143538\t145883\t145942\t145992\t146040\t146088\t15200  17760  25817  29035  63246  8502\n10950\t113531\t115700\t118297\t121919\t123309\t130301\t131852\t131961\t132382\t142945\t143179\t143284\t143426\t143539\t145885\t145943\t145993\t146041\t146089\t15201  18     25818  29036  63247  8503\n10959\t113538\t115701\t1183\t121920\t123310\t130309\t131853\t131962\t132386\t142946\t143181\t143285\t143432\t143540\t145886\t145944\t145994\t146042\t146090\t15202  18127  25819  29037  63248  87915\n10967\t113540\t115702\t118323\t121935\t123311\t130318\t131857\t132012\t132387\t142947\t143182\t143287\t143436\t143541\t145887\t145945\t145995\t146043\t146091\t15203  18128  25820  3\t    63249  87918\n10972\t113541\t115703\t118324\t121936\t123312\t130330\t131858\t132014\t132388\t142953\t143185\t143299\t143438\t143560\t145889\t145946\t145996\t146044\t146092\t15204  18129  25821  311    64408  87919\n10973\t113542\t115708\t118325\t121937\t123313\t130340\t131862\t132015\t132389\t142954\t143187\t143300\t143439\t143563\t145891\t145947\t145997\t146045\t146093\t15205  18130  25822  312    64409  87922\n10983\t113545\t115709\t118326\t121938\t123362\t130341\t131863\t132054\t132390\t142955\t143189\t143301\t143441\t143564\t145892\t145948\t145998\t146046\t146094\t15206  18131  25823  313    64410  88468\n109958\t113546\t115713\t118327\t121939\t123364\t130352\t131867\t132055\t132395\t142956\t143190\t143302\t143442\t143565\t145893\t145949\t145999\t146047\t146095\t15207  18132  25824  314    7\t   88470\n109959\t11368\t115715\t118328\t121940\t123366\t130366\t131868\t132058\t132396\t142957\t143191\t143303\t143443\t143566\t145894\t145950\t146000\t146048\t146096\t15208  18137  28992  315    7369   88472\n109960\t11370\t115716\t118329\t121941\t123367\t130378\t131871\t132069\t132397\t142958\t143193\t143304\t143446\t143567\t145895\t145951\t146001\t146049\t146097\t15209  18138  28993  31861  74694  9\n109961\t11372\t115717\t118330\t121972\t123856\t130389\t131872\t132077\t1374\t142961\t143196\t143315\t143447\t143570\t145896\t145952\t146002\t146050\t146098\t15210  18139  28994  320    7660   94825\n109962\t11374\t115718\t118331\t121973\t123857\t130403\t131876\t132089\t1375\t142963\t143198\t143320\t143448\t143571\t145897\t145954\t146003\t146051\t146099\t15211  18383  28995  321    7661   94826\n109963\t11376\t115719\t118332\t121974\t123858\t130409\t131877\t132103\t1376\t142966\t143199\t143327\t143449\t143595\t145898\t145955\t146004\t146052\t146100\t15214  19     28996  4\t    7662   94827\n11\t11377\t115720\t118333\t121975\t123859\t130412\t131880\t132117\t1381\t142968\t143201\t143328\t143450\t143596\t145901\t145956\t146005\t146053\t146101\t15215  19458  28997  45561  7663   94828\n11005\t11378\t117602\t118334\t121976\t123860\t130418\t131881\t132119\t1382\t142971\t143202\t143330\t143451\t144380\t145902\t145957\t146006\t146054\t15\t15216  19459  28998  45562  7664\n11032\t11379\t117612\t118335\t121977\t123861\t130419\t131885\t132186\t1383\t142972\t143203\t143331\t143491\t144381\t145903\t145958\t146007\t146055\t15137\t15217  19460  28999  45572  7665\n11040\t11380\t117637\t118336\t121978\t123862\t130428\t131886\t132196\t14\t142974\t143204\t143332\t143494\t144450\t145904\t145959\t146008\t146056\t15138\t15218  19461  29000  45573  7666\n11056\t11381\t117638\t118337\t121979\t123863\t130445\t131889\t132200\t142806\t142976\t143205\t143333\t143495\t144451\t145905\t145960\t146009\t146057\t15139\t15219  2      29001  46731  7667\n11075\t11382\t117644\t118338\t121980\t123864\t130517\t131890\t132214\t142807\t142978\t143212\t143336\t143496\t144452\t145906\t145961\t146010\t146058\t15140\t15220  20     29004  46732  7668\n11088\t11383\t117646\t118339\t121981\t123865\t130552\t131894\t132216\t142808\t142979\t143214\t143337\t143497\t144457\t145907\t145962\t146011\t146059\t15141\t15221  20180  29006  46733  7669\n11097\t11384\t11769\t118340\t121982\t123866\t130572\t131895\t132218\t142810\t142984\t143216\t143338\t143498\t144458\t145908\t145964\t146012\t146060\t15142\t15222  21     29007  46734  7670\n11110\t114177\t11770\t118341\t121983\t123867\t130573\t131898\t132220\t142813\t142985\t143217\t143343\t143499\t144459\t145909\t145965\t146013\t146061\t15143\t15223  22     29008  46735  7671\n11113\t114178\t117746\t118342\t121984\t123868\t130574\t131899\t132222\t142815\t142988\t143218\t143348\t143500\t144482\t145910\t145966\t146014\t146062\t15144\t15224  22399  29009  46757  7672\n111680\t114179\t117747\t118409\t121985\t123869\t130597\t131903\t132224\t142817\t142990\t143219\t143349\t143501\t144483\t145911\t145967\t146015\t146063\t15145\t15225  22410  29010  46758  7673\n111709\t114180\t117748\t118410\t121986\t123870\t130598\t131904\t132227\t142819\t142991\t143220\t143351\t143502\t144484\t145912\t145968\t146016\t146064\t15146\t15226  2474   29011  46759  8\n111715\t114318\t117749\t118414\t122002\t123871\t130599\t131907\t132233\t142822\t142995\t143221\t143357\t143503\t144485\t145913\t145969\t146017\t146065\t15147\t1542   2475   29012  46760  8022\n111716\t114321\t117750\t118415\t122005\t124270\t130600\t131908\t132236\t142823\t142998\t143235\t143361\t143504\t144499\t145915\t145970\t146018\t146066\t15148\t1543   2476   29013  46761  8024\n111720\t114352\t117751\t11874\t122007\t124292\t130601\t131912\t132257\t142824\t143001\t143239\t143362\t143512\t144500\t145918\t145971\t146019\t146067\t15149\t1544   2477   29014  477    8029\n111722\t114364\t1178\t11875\t122017\t124296\t131539\t131913\t132258\t142825\t143003\t143241\t143363\t143514\t145853\t145919\t145972\t146020\t146068\t15150\t1545   2478   29015  5\t    8037\n111753\t114698\t1180\t119940\t122023\t124311\t131567\t131916\t132341\t142826\t143005\t143242\t143381\t143515\t145854\t145921\t145973\t146021\t146069\t15159\t1546   2479   29016  50211  8053\n111755\t114701\t118267\t11999\t122024\t124312\t131762\t131917\t132342\t142827\t143008\t143243\t143382\t143516\t145859\t145922\t145974\t146022\t146070\t15160\t1547   2480   29017  50212  81454\n111825\t114710\t118278\t12\t122027\t124670\t131763\t131921\t132343\t142828\t143019\t143245\t143383\t143517\t145860\t145923\t145975\t146023\t146071\t15161\t1548   25766  29018  50213  81457\n111826\t114967\t118279\t12000\t122029\t124676\t131766\t131922\t132344\t142829\t143026\t143247\t143384\t143518\t145861\t145924\t145976\t146024\t146072\t15162\t1549   25767  29019  50214  81458\n111827\t114969\t118280\t12001\t122058\t124682\t131767\t131925\t132345\t142830\t143030\t143249\t143386\t143519\t145862\t145925\t145977\t146025\t146073\t15163\t1550   25768  29020  50215  81459\n111828\t114970\t118281\t12002\t122062\t124683\t131805\t131926\t132346\t142831\t143038\t143250\t143387\t143520\t145863\t145926\t145978\t146026\t146074\t15184\t1551   25777  29021  50216  81460\n111830\t114973\t118282\t12003\t122066\t125304\t131806\t131930\t132347\t142832\t143137\t143251\t143388\t143523\t145864\t145927\t145979\t146027\t146075\t15185\t1552   25778  29022  50217  81461\n111833\t114976\t118283\t12004\t122069\t125315\t131807\t131931\t132348\t142833\t143141\t143252\t143389\t143524\t145865\t145928\t145980\t146028\t146076\t15186\t1553   25779  29023  54     8490```",
      "time": "14:29",
      "timestamp": "1751491783.364779",
      "is_reply": true
    },
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": "A simple prune doesn’t seem to cleanup much\n```cs/mfichman❯ docker system prune\nWARNING! This will remove:\n  - all stopped containers\n  - all networks not used by at least one container\n  - all dangling images\n  - unused build cache\n\nAre you sure you want to continue? [y/N] y\n\nDeleted build cache objects:\n3b3bped8h3j133g165fxq78gm\nd4lj00xdc8u85qlbg1xmgjfm6\n54ene8gvus9cf0enpvej97jw1\nlo3if3q0i919dcifxnmod8pgq\nqe80bcshu36mamg4r4emkptcc\n\nTotal reclaimed space: 81.92kB```",
      "time": "14:30",
      "timestamp": "1751491802.317559",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "I think others have had success with prune -a",
      "time": "16:22",
      "timestamp": "1751498527.807979",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "For some reason, plain prune doesn't seem to work that well.",
      "time": "16:22",
      "timestamp": "1751498537.613529",
      "is_reply": true
    },
    {
      "sender": "Anil",
      "user_id": "U01BH8XBR55",
      "message": "I did `prune -a` - that deleted 50GB\nIf your box, the bazel disk cache is missing a size limit\n.cache folder is 150GB",
      "time": "16:26",
      "timestamp": "1751498770.972929",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Yeah, it's super annoying. No matter what I do, the bazel cache seems to grow. I set some options that are supposed to limit its size, but they don't work.",
      "time": "18:44",
      "timestamp": "1751507057.713479",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C05L87V014J",
    "channel_name": "ask-crafting",
    "date_file": "2025-07-02.json",
    "message_count": 7,
    "start_time": "1751488375.059369",
    "end_time": "1751507057.713479",
    "is_thread": true
  }
}