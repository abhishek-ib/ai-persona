{
  "id": "ch_CSY11CK7T_2024-10-18_1729279422.353379_thread",
  "type": "channel",
  "channel_name": "discuss-frontend",
  "conversation_type": "thread",
  "participants": [
    "Xindi Xu",
    "mfichman"
  ],
  "messages": [
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "@mfichman i'm unable to load up IB classic in crafting with your new nginx changes :cry: . I don't see any logs from server-nginx neither. Do we need another crafting sandbox template to load IB classic?",
      "time": "12:23",
      "timestamp": "1729279422.353379",
      "is_reply": false
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "",
      "time": "12:30",
      "timestamp": "1729279857.067199",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "You mean unable?",
      "time": "12:31",
      "timestamp": "1729279882.044019",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Link to sandbox?",
      "time": "12:31",
      "timestamp": "1729279890.750709",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "oops, yep. can't load it up",
      "time": "12:31",
      "timestamp": "1729279901.218669",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Send me a link if you don't mind",
      "time": "12:31",
      "timestamp": "1729279914.265209",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "https://instabase.sandboxes.site/sandboxes/xindixu-v2",
      "time": "12:31",
      "timestamp": "1729279917.451659",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Send me the URL from your browser too :)",
      "time": "12:32",
      "timestamp": "1729279942.553379",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "https://localhost/",
      "time": "12:32",
      "timestamp": "1729279954.051459",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "try `http://localhost` :slightly_smiling_face: :slightly_smiling_face:",
      "time": "12:32",
      "timestamp": "1729279964.786179",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Same thing :thinking_face:",
      "time": "12:33",
      "timestamp": "1729279995.141619",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Hm, OK. Let me check that nginx is running in your sandbox.",
      "time": "12:33",
      "timestamp": "1729280012.768169",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "How do you usually set up the tunnel from the crafting sandbox to your laptop?",
      "time": "12:34",
      "timestamp": "1729280068.434949",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "```âžœ  ~ curl -I http://localhost\nHTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 18 Oct 2024 19:34:35 GMT\nContent-Type: text/html; charset=utf-8\nConnection: keep-alive\nCache-Control: no-cache, no-store, must-revalidate, public, max-age=0\nPragma: no-cache\nExpires: 0\nIB-Trace-Id: null\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block```\nnginx is up and running; I think the tunnel to your laptop is broken",
      "time": "12:34",
      "timestamp": "1729280091.232219",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Probably need to do something like:\n\n```cs ssh -- -L80:localhost:80 -N```",
      "time": "12:35",
      "timestamp": "1729280123.225689",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "I see. I'll try that.",
      "time": "12:35",
      "timestamp": "1729280159.981829",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "I usually do `sudo sh -c \"CRAFTING_SANDBOX_SERVER_URL=https://instabase.sandboxes.site cs pf -P -F -L 443:dev:443 -L 8600:localhost:8600 -W $CRAFTING_SANDBOX\"`",
      "time": "12:37",
      "timestamp": "1729280233.039219",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Ah yeah change that to:",
      "time": "12:37",
      "timestamp": "1729280248.279079",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "```sudo sh -c \"CRAFTING_SANDBOX_SERVER_URL=https://instabase.sandboxes.site cs pf -P -F -L 80:dev:80 -L 8600:localhost:8600 -W $CRAFTING_SANDBOX\"```",
      "time": "12:37",
      "timestamp": "1729280255.531589",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "I tried that but not working",
      "time": "12:37",
      "timestamp": "1729280267.627499",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "OK, let me try your exact command",
      "time": "12:38",
      "timestamp": "1729280287.950629",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "I also don't see any logs from server nginx. Is that normal?",
      "time": "12:38",
      "timestamp": "1729280290.003809",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "It would be if the tunnel to your laptop isn't set up right. Anyway, try logging directly into your sandbox and running curl. It's up.",
      "time": "12:38",
      "timestamp": "1729280318.135209",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Ah okay. I see that working now!",
      "time": "12:40",
      "timestamp": "1729280441.958009",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Hm, worked for me",
      "time": "12:40",
      "timestamp": "1729280444.612339",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "OK :slightly_smiling_face:",
      "time": "12:40",
      "timestamp": "1729280446.471539",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Only problem is webpack may be down?",
      "time": "12:40",
      "timestamp": "1729280454.467409",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Here's what I see:",
      "time": "12:40",
      "timestamp": "1729280458.196169",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "",
      "time": "12:42",
      "timestamp": "1729280520.032809",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Actually, I think just some of the bundles are missing. Maybe missing from ibdev.json?",
      "time": "12:42",
      "timestamp": "1729280531.459389",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Oh, never mind, it was a firefox problem. Disregard. I think it's working, but lmk if not!",
      "time": "12:42",
      "timestamp": "1729280557.754139",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "yea... i need to tweak that file",
      "time": "12:43",
      "timestamp": "1729280608.840759",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Nice! Everything is working now :blob-dance:  Thank you so much",
      "time": "12:46",
      "timestamp": "1729280787.976439",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "OK!! No cert problems, and livereload should work now. Hope it was worth it :laughing: !!",
      "time": "12:47",
      "timestamp": "1729280840.893849",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "I do see one more issue, not sure if that's related:\n`api/v1/accounts/list_users` response with error\n```{\n    \"status\": \"ERROR\",\n    \"msg\": \"400 Bad Request: The referrer does not match the host.\"\n}```\nBut the other API requests are fine...",
      "time": "12:49",
      "timestamp": "1729280967.998309",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Hm, interesting. I don't think it's related, but are other API endpoints working?",
      "time": "12:50",
      "timestamp": "1729281017.299259",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "We might need to change `instabase_uri` in env-local.json to `http://localhost`",
      "time": "12:51",
      "timestamp": "1729281089.548579",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Oh, possibly. Does that fix it?",
      "time": "12:52",
      "timestamp": "1729281125.749189",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Oh, i think other endpoints work because they are GET requests. Looks like any POST request will fail.",
      "time": "12:54",
      "timestamp": "1729281285.561789",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Changing it doesn't help",
      "time": "12:55",
      "timestamp": "1729281302.422449",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Huh, I didn't have this problem before. What do the nginx logs say?",
      "time": "13:02",
      "timestamp": "1729281735.441339",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "BTW, xindi, you can also use this instead of tunneling https://ppy-server-nginx--xindixu-v2-instabase.instabase.site.sandboxes.run/",
      "time": "13:03",
      "timestamp": "1729281803.906329",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Removes the need to tunnel at all",
      "time": "13:03",
      "timestamp": "1729281810.130849",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "```{\"msec\": \"1729281659.523\", \"connection\": \"164\", \"connection_requests\": \"7\", \"pid\": \"16\", \"request_id\": \"a38fc19d839ed69b03023e0d875eb393\", \"request_length\": \"1217\", \"remote_addr\": \"169.254.31.254\", \"remote_user\": \"\", \"remote_port\": \"34656\", \"time_local\": \"18/Oct/2024:20:00:59 +0000\", \"time_iso8601\": \"2024-10-18T20:00:59+00:00\", \"request\": \"POST /api/v1/accounts/list_users HTTP/1.1\", \"request_uri\": \"/api/v1/accounts/list_users\", \"args\": \"\", \"status\": \"200\", \"body_bytes_sent\": \"84\", \"bytes_sent\": \"497\", \"http_referer\": \"http://localhost/apps/admin/users\", \"http_user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36\", \"http_x_forwarded_for\": \"\", \"http_host\": \"localhost\", \"server_name\": \"\", \"request_time\": \"0.003\", \"upstream\": \"172.17.0.1:5555\", \"upstream_connect_time\": \"0.000\", \"upstream_header_time\": \"0.003\", \"upstream_response_time\": \"0.003\", \"upstream_response_length\": \"84\", \"upstream_cache_status\": \"\", \"ssl_protocol\": \"\", \"ssl_cipher\": \"\", \"scheme\": \"http\", \"request_method\": \"POST\", \"server_protocol\": \"HTTP/1.1\", \"pipe\": \".\", \"gzip_ratio\": \"\", \"http_cf_ray\": \"\",}```",
      "time": "13:03",
      "timestamp": "1729281812.082739",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Lmk if that other link works for you",
      "time": "13:04",
      "timestamp": "1729281879.373559",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "yep, the other link works",
      "time": "13:07",
      "timestamp": "1729282036.899939",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "OK. I'll look into localhost problem.",
      "time": "13:08",
      "timestamp": "1729282085.887469",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "Thank you! btw, it works when I use postman. I wonder if this has to do with CSRF",
      "time": "13:11",
      "timestamp": "1729282275.025979",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "That seems possible. I'll take a look!",
      "time": "13:12",
      "timestamp": "1729282374.728039",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "oh, another thing. AIHub frontend loads up without any issues at http://localhost. GET/POST requests are working as expected",
      "time": "13:20",
      "timestamp": "1729282810.898129",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Huh, so just IB classic? That is odd.",
      "time": "13:21",
      "timestamp": "1729282895.470059",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "BTW, on `master` I removed the `if not aihub` blocks from the nginx config.",
      "time": "13:22",
      "timestamp": "1729282921.890839",
      "is_reply": true
    },
    {
      "sender": "mfichman",
      "user_id": "U03DZ9XUE10",
      "message": "Those blocks are still there on the 24.07 branch of course.",
      "time": "13:22",
      "timestamp": "1729282936.533909",
      "is_reply": true
    },
    {
      "sender": "Xindi Xu",
      "user_id": "U03FT35MAHF",
      "message": "gotcha. I was on the same commit on master when I tried aihub vs IB classic",
      "time": "13:23",
      "timestamp": "1729282981.674489",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "CSY11CK7T",
    "channel_name": "discuss-frontend",
    "date_file": "2024-10-18.json",
    "message_count": 54,
    "start_time": "1729279422.353379",
    "end_time": "1729282981.674489",
    "is_thread": true
  }
}