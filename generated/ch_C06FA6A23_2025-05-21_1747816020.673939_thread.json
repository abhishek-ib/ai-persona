{
  "id": "ch_C06FA6A23_2025-05-21_1747816020.673939_thread",
  "type": "channel",
  "channel_name": "discuss-engineering",
  "conversation_type": "thread",
  "participants": [
    "Cody Boggs",
    "Cheryl Zhou",
    "jordy.vlan",
    "Victor Zeng",
    "Serena"
  ],
  "messages": [
    {
      "sender": "jordy.vlan",
      "user_id": "U072CDMB4N8",
      "message": "@Yash Botadra what for are we using conversion to ONNX? This seems more of a dev dependency.",
      "time": "01:27",
      "timestamp": "1747816020.673939",
      "is_reply": false
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "I actually think I might have gotten it, if we're OK with using a git commit for `skl2onnx`\nhttps://github.com/instabase/instabase/pull/70847",
      "time": "06:50",
      "timestamp": "1747835421.101709",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "CI is still running (it'll be a looong one) but if you wanna follow along here (https://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%228y5%22:%7B%22datasource%22:%22loki%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bservice_name%3D%60jenkins-preprod%60%7D%20%7C%20trace_id%3D%60caea171349b754802aa977d519447257%60%22,%22queryType%22:%22range%22,%22datasource%22:%7B%22type%22:%22loki%22,%22uid%22:%22loki%22%7D,%22editorMode%22:%22code%22,%22direction%22:%22backward%22%7D%5D,%22range%22:%7B%22from%22:%22now-3h%22,%22to%22:%22now%22%7D,%22panelsState%22:%7B%22logs%22:%7B%22visualisationType%22:%22logs%22%7D%7D%7D%7D&orgId=1), the \"Live\" button in the top right is nice. lol",
      "time": "07:23",
      "timestamp": "1747837416.661279",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Whoa... Pre-Merge passed first try. :open_mouth:\nhttps://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%228y5%22:%7B%22datas[…]B%22visualisationType%22:%22logs%22%7D%7D%7D%7D&orgId=1 (https://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%228y5%22:%7B%22datasource%22:%22loki%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bservice_name%3D%60jenkins-preprod%60%7D%20%7C%20trace_id%3D%60caea171349b754802aa977d519447257%60%20%7C%20ci_pipeline_id%3D%5C%22instabase%2FPR-70847%5C%22%22,%22queryType%22:%22range%22,%22datasource%22:%7B%22type%22:%22loki%22,%22uid%22:%22loki%22%7D,%22editorMode%22:%22code%22,%22direction%22:%22backward%22%7D%5D,%22range%22:%7B%22from%22:%221747835096389%22,%22to%22:%221747838066389%22%7D,%22panelsState%22:%7B%22logs%22:%7B%22visualisationType%22:%22logs%22%7D%7D%7D%7D&orgId=1)",
      "time": "07:50",
      "timestamp": "1747839021.862309",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "And more quickly than I'd have expected too. Only took ~41 minutes, I expected at least an hour+. :thonk:\n\nPerhaps that's a huge piece of our slow pre-merge runs: ancient dependencies. lol",
      "time": "07:54",
      "timestamp": "1747839242.391309",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "I have a way to force a 'full' run of lots of suites, so I'll try that too just to see what I get. :face_with_monocle:",
      "time": "07:59",
      "timestamp": "1747839579.400819",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Sandbox is still creating (https://sandbox.console.instabase.com/customer/Engineering/tenant/prodeng-1721-pb/info) but with any luck... :crossed_fingers::skin-tone-3:",
      "time": "08:00",
      "timestamp": "1747839602.931319",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Various unit test pipelines are updated to pull this branch and runs thereupon are underway",
      "time": "08:07",
      "timestamp": "1747840026.547589",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "And for good measure, added inert comments to a number of 'important' python files to trigger lots of py tests in pre-merge:\nhttps://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%228y5%22:%7B%22datas[…]B%22visualisationType%22:%22logs%22%7D%7D%7D%7D&orgId=1 (https://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%228y5%22:%7B%22datasource%22:%22loki%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bservice_name%3D%60jenkins-preprod%60%7D%20%7C%20ci_pipeline_id%3D%5C%22instabase%2FPR-70847%5C%22%20%7C%20ci_pipeline_run_number%3D2%22,%22queryType%22:%22range%22,%22datasource%22:%7B%22type%22:%22loki%22,%22uid%22:%22loki%22%7D,%22editorMode%22:%22code%22,%22direction%22:%22backward%22%7D%5D,%22range%22:%7B%22from%22:%22now-3h%22,%22to%22:%22now%22%7D,%22panelsState%22:%7B%22logs%22:%7B%22visualisationType%22:%22logs%22%7D%7D%7D%7D&orgId=1)",
      "time": "08:09",
      "timestamp": "1747840154.607179",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Logs for Unit Test pipelines: https://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%2260q%22:%7B%22datas[…]22:%22labels%22,%22refId%22:%22A%22%7D%7D%7D%7D&orgId=1 (https://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%2260q%22:%7B%22datasource%22:%22loki%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bservice_name%3D%5C%22jenkins-prod%5C%22%7D%20%7C%20ci_pipeline_id%20%3D~%20%60tests%2FUnit%20tests%2FUnit-%28Cpp%7CGo%7CJava%7CJs%7CPy3%7CPyDocker%29Tests-Release%2Fprodeng-1721-proto%60%20%7C~%20%60Finished:%20.%2B%60%22,%22queryType%22:%22range%22,%22datasource%22:%7B%22type%22:%22loki%22,%22uid%22:%22loki%22%7D,%22editorMode%22:%22code%22,%22direction%22:%22backward%22,%22maxLines%22:5000%7D%5D,%22range%22:%7B%22from%22:%22now-1h%22,%22to%22:%22now%22%7D,%22panelsState%22:%7B%22logs%22:%7B%22columns%22:%7B%220%22:%22Time%22,%221%22:%22Line%22,%222%22:%22ci_pipeline_id%22,%223%22:%22ci_pipeline_run_number%22%7D,%22visualisationType%22:%22table%22,%22labelFieldName%22:%22labels%22,%22refId%22:%22A%22%7D%7D%7D%7D&orgId=1)\n\nJust filtered down to the `Finished: .+` lines for a quicker view at what worked and what didn't. lol",
      "time": "08:19",
      "timestamp": "1747840770.972329",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Awww man\nJS Unit tests are the only holdout, failed each run. Lame. lol",
      "time": "10:11",
      "timestamp": "1747847474.311589",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Also the 'heavy' CI Pre-Merge run that I forced is still running 2+ hours in, so .... definitely _not_ faster yet. haha\n\nWith any luck the caching of these bits in engflow will make the re-run faster though. Too little data for a meaningful trend yet. :crossed_fingers::skin-tone-3:",
      "time": "10:13",
      "timestamp": "1747847606.408629",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "@Heymian @Serena I'm getting very excited at the prospect of this upgrade working - and now I might need some help with getting the JS unit tests pipeline (https://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%2260q%22:%7B%22datasource%22:%22loki%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bservice_name%3D%5C%22jenkins-prod%5C%22%7D%20%7C%20ci_pipeline_id%20%3D%20%60tests%2FUnit%20tests%2FUnit-JsTests-Release%2Fprodeng-1721-proto%60%20%7C%20ci_pipeline_run_number%20%3D%203%22,%22queryType%22:%22range%22,%22datasource%22:%7B%22type%22:%22loki%22,%22uid%22:%22loki%22%7D,%22editorMode%22:%22code%22,%22direction%22:%22forward%22,%22maxLines%22:5000%7D%5D,%22range%22:%7B%22from%22:%221747844083391%22,%22to%22:%221747846065043%22%7D,%22panelsState%22:%7B%22logs%22:%7B%22columns%22:%7B%220%22:%22Time%22,%221%22:%22Line%22,%222%22:%22ci_pipeline_id%22,%223%22:%22ci_pipeline_run_number%22%7D,%22visualisationType%22:%22logs%22,%22labelFieldName%22:%22labels%22,%22refId%22:%22A%22%7D%7D%7D%7D&orgId=1) passing... and I _haven't the foggiest_ idea how any of it works :lolcry:\nAny good contacts I could ping for a hand?\n\n(Trouble with being a hyper-generalist - too many generals to keep up :melting_face:)",
      "time": "10:23",
      "timestamp": "1747848199.425019",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "this is a known flaky test :disappointed: so i'd recommend rerunning the unit test pipeline",
      "time": "12:29",
      "timestamp": "1747855790.488699",
      "is_reply": true
    },
    {
      "sender": "Serena",
      "user_id": "U01CZ3LBFU4",
      "message": "@Paul H has tried to introduce a fix for the flaky test here (https://github.com/instabase/instabase/pull/70801/commits/e9a8a23bc437ac3920ed38b27fc6f68bc654b37d), so you could also try rebasing on master?",
      "time": "12:30",
      "timestamp": "1747855842.341489",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Ooh nice!\nI rebased to get another fix in (for a PIA breakage) and now it's passing :dancing-penguin: Seems I got Paul's fix lol\nThis was failing consistently in the first 5 runs, then #6 passed right after the rebase + force push :dancing-penguin: x2\n:smile:\n\nSweeeet!!",
      "time": "13:21",
      "timestamp": "1747858874.395719",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "I did miss that py3 tests are failing though :lolcry:\nwomp womp\n\nhttps://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%2260q%22:%7B%22datas[…]22:%22labels%22,%22refId%22:%22A%22%7D%7D%7D%7D&orgId=1 (https://grafana.infra.instabase.com/explore?schemaVersion=1&panes=%7B%2260q%22:%7B%22datasource%22:%22loki%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bservice_name%3D%5C%22jenkins-prod%5C%22%7D%20%7C%20ci_pipeline_id%20%3D%20%60tests%2FUnit%20tests%2FUnit-Py3Tests-Release%2Fprodeng-1721-proto%60%20%7C%20ci_pipeline_run_number%20%3D%202%22,%22queryType%22:%22range%22,%22datasource%22:%7B%22type%22:%22loki%22,%22uid%22:%22loki%22%7D,%22editorMode%22:%22code%22,%22direction%22:%22forward%22,%22maxLines%22:5000%7D%5D,%22range%22:%7B%22from%22:%221747843898621%22,%22to%22:%221747854015356%22%7D,%22panelsState%22:%7B%22logs%22:%7B%22columns%22:%7B%220%22:%22Time%22,%221%22:%22Line%22,%222%22:%22ci_pipeline_id%22,%223%22:%22ci_pipeline_run_number%22%7D,%22visualisationType%22:%22logs%22,%22labelFieldName%22:%22labels%22,%22refId%22:%22A%22%7D%7D%7D%7D&orgId=1)",
      "time": "13:22",
      "timestamp": "1747858923.385289",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Ah, mypy incompatibility. Betcha I can fix that at some point. :smile:\n```mypy 0.812 requires mypy-extensions<0.5.0,>=0.4.3, but you have mypy-extensions 1.0.0 which is incompatible.```",
      "time": "13:28",
      "timestamp": "1747859337.829879",
      "is_reply": true
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "Which branch is this? I thought I bumped it to 1.11.2",
      "time": "13:37",
      "timestamp": "1747859867.170469",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Oooh I see what happened\nIt's odd, but yea\nSo the `gcr.io/instabase-build/ci-unit-tests:25.04.02.00.27.29 (http://gcr.io/instabase-build/ci-unit-tests:25.04.02.00.27.29)` image has `mypy==0.812` and `mypy-extensions==0.4.4` installed directly - and the _uninstallation_ of it is triggering a version compatibility error. Go figure. lol\n\nI'll rebuild a new one with those explicitly uninstalled and just not replace them, since we install the bits from `third-party/bazel/py/mypy_version_py39.txt` anyway",
      "time": "13:44",
      "timestamp": "1747860265.515949",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Guess I can yank 3.7 from that image too :joy:",
      "time": "14:04",
      "timestamp": "1747861442.265339",
      "is_reply": true
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "That would be great.",
      "time": "14:11",
      "timestamp": "1747861907.620839",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "(Yay for other breakages that I need to fix too :joy: might well while we're under the hood eh)",
      "time": "14:13",
      "timestamp": "1747862001.449739",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "@Victor Zeng Ok, I have the image updated and it seems like a legit failure now:\nhttps://grafana.infra.instabase.com/goto/wYPOnj-Hg?orgId=1\n\n```2025-05-21 15:37:40.831\t\nTYPECHECKING FAILURE: mypy exited with code 1\n\t\n\t\n2025-05-21 15:37:40.831\t\ninstabase/api_server/handler/api/private/mounts.py:50: error: \"MountServiceStub\" has no attribute \"DeleteMountPoint\"; maybe \"GetMountPoint\", \"CreateMountPoint\", or \"GetMountPoints\"?  [attr-defined]\n\t\n\t\n2025-05-21 15:37:40.831\t\ninstabase/api_server/handler/api/private/mounts.py:51: error: Module has no attribute \"DeleteMountPointReq\"; maybe \"CreateMountPointReq\", \"UpdateMountPointReq\", or \"CreateMountPointResp\"?  [attr-defined]\n\t\n\t\n2025-05-21 15:37:40.831\t\nFound 2 errors in 1 file (checked 1607 source files)```",
      "time": "14:48",
      "timestamp": "1747864134.769679",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Any tips? lol",
      "time": "14:48",
      "timestamp": "1747864139.695769",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "(branch is `prodeng-1721-proto` if you're curious)",
      "time": "14:49",
      "timestamp": "1747864154.882759",
      "is_reply": true
    },
    {
      "sender": "Victor Zeng",
      "user_id": "U03JT46AUPP",
      "message": "Try rebuilding protos in api-server with `FAST=false`",
      "time": "14:50",
      "timestamp": "1747864227.747879",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "~K I don't actually know what the right make target is for that~ :thonk:\nooor I could bother to look at the docs :joy: sorry",
      "time": "14:55",
      "timestamp": "1747864540.523459",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Lame, no change in the repo when I run `make build-protos FAST=false` in `webserver/api-server`",
      "time": "15:06",
      "timestamp": "1747865192.799509",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Oh shoot\nI wound up with the old deps installed again\nI'll fix that lol",
      "time": "15:09",
      "timestamp": "1747865365.834959",
      "is_reply": true
    },
    {
      "sender": "Cheryl Zhou",
      "user_id": "U030KCEN6NA",
      "message": "took a quick look at mount_service.proto it doesn't seem like we don't have these attributes. we might have to add them",
      "time": "15:37",
      "timestamp": "1747867060.399089",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "I think I wound up with my branch in a very strange state, so I'm working on that for now. Sorry for the wag, this might have only been as half-smooth as I thought it was because of a misfire on my side. :thonk:",
      "time": "15:41",
      "timestamp": "1747867281.025799",
      "is_reply": true
    },
    {
      "sender": "Cheryl Zhou",
      "user_id": "U030KCEN6NA",
      "message": "ahh no worries! i can help with a fix on this one. PR: https://github.com/instabase/instabase/pull/70867",
      "time": "15:43",
      "timestamp": "1747867431.785189",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Thanks!",
      "time": "15:44",
      "timestamp": "1747867443.723769",
      "is_reply": true
    },
    {
      "sender": "Cheryl Zhou",
      "user_id": "U030KCEN6NA",
      "message": "can i have a stamp please? https://github.com/instabase/instabase/pull/70867",
      "time": "16:48",
      "timestamp": "1747871323.572439",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Sorry, didn't feel like it was wise for _me_ to stamp that one since I don't know what I'm doing :rolling_on_the_floor_laughing:",
      "time": "17:46",
      "timestamp": "1747874814.668809",
      "is_reply": true
    },
    {
      "sender": "Cody Boggs",
      "user_id": "U037PKN4USZ",
      "message": "Well, this is a weird place to end the day but here we are\n```Traceback (most recent call last):\n18:38:31    File \"/instabase_dir/shared-utils/py-utils/solution-utils/../../../shared-utils/py-utils/typing-utils/src/py/scripts/run_mypy.py\", line 307, in <module>\n18:38:31      main()\n18:38:31    File \"/instabase_dir/shared-utils/py-utils/solution-utils/../../../shared-utils/py-utils/typing-utils/src/py/scripts/run_mypy.py\", line 275, in main\n18:38:31      p = subprocess.Popen(\n18:38:31    File \"/home/jenkins/pyenv/versions/3.9.17/lib/python3.9/subprocess.py\", line 951, in __init__\n18:38:31      self._execute_child(args, executable, preexec_fn, close_fds,\n18:38:31    File \"/home/jenkins/pyenv/versions/3.9.17/lib/python3.9/subprocess.py\", line 1837, in _execute_child\n18:38:31      raise child_exception_type(errno_num, err_msg, err_filename)\n18:38:31  FileNotFoundError: [Errno 2] No such file or directory: 'mypy'```\n:expressionless: Color me bamboozled",
      "time": "17:47",
      "timestamp": "1747874868.706219",
      "is_reply": true
    }
  ],
  "metadata": {
    "channel_id": "C06FA6A23",
    "channel_name": "discuss-engineering",
    "date_file": "2025-05-21.json",
    "message_count": 37,
    "start_time": "1747816020.673939",
    "end_time": "1747874868.706219",
    "is_thread": true
  }
}